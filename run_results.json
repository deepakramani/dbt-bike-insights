{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v6.json", "dbt_version": "1.9.3", "generated_at": "2025-04-05T20:51:06.230064Z", "invocation_id": "8a8ac68b-f45d-4d21-a645-b4dc8e6e858e", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.535139Z", "completed_at": "2025-04-05T20:51:04.546922Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.547521Z", "completed_at": "2025-04-05T20:51:04.547534Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.013700246810913086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.change_over_time", "compiled": true, "compiled_code": "/*\n===============================================================================\nChange Over Time Analysis\n===============================================================================\nPurpose:\n    - To track trends, growth, and changes in key metrics over time.\n    - For time-series analysis and identifying seasonality.\n    - To measure growth or decline over specific periods.\n\nSQL Functions Used:\n    - Date Functions: DATEPART(), DATETRUNC(), FORMAT()\n    - Aggregate Functions: SUM(), COUNT(), AVG()\n===============================================================================\n*/\n-- Analyse sales performance over time\n-- Quick Date Functions\nselect\n    year(sales_order_date) as order_year,\n    --month(sales_order_date) as order_month,\n    sum(sales_amount) as total_sales,\n    count(distinct customer_skey) as total_customers,\n    sum(sales_quantity) as total_items,\nfrom \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_order_date is not null\ngroup by order_year--, order_month\norder by order_year;\n\n/*\n order_year,total_sales,total_customers,total_items\n2010,43419,14,14\n2011,7075088,2216,2216\n2012,5842231,3255,3397\n2013,16344878,17427,52807\n2014,45642,834,1970\n\n */\n-- similarly if the trend is checked by month.\nselect\n--     year(sales_order_date) as order_year,\n    month(sales_order_date) as order_month,\n    sum(sales_amount) as total_sales,\n    count(distinct customer_skey) as total_customers,\n    sum(sales_quantity) as total_items,\nfrom  \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_order_date is not null\ngroup by order_month\norder by order_month;\n\n-- finds the month in which sales or customers are highest(dec) and next query lowest(feb).\nwith monthly_sales as (select\n--     year(sales_order_date) as order_year,\n    month(sales_order_date) as order_month,\n    sum(sales_amount) as total_sales,\n    count(distinct customer_skey) as total_customers,\n    sum(sales_quantity) as total_items,\nfrom  \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_order_date is not null\ngroup by order_month\norder by order_month)\nSELECT\n    order_month,\n    total_sales,\n    total_customers,\n    total_items,\n    RANK() OVER (ORDER BY total_sales desc) AS sales_rank,\n    RANK() OVER (ORDER BY total_customers desc) AS customer_rank\nFROM monthly_sales\nqualify sales_rank = 1 or customer_rank = 1\nORDER BY sales_rank, customer_rank;\n\n--lowest\nwith monthly_sales as (select\n--     year(sales_order_date) as order_year,\n    month(sales_order_date) as order_month,\n    sum(sales_amount) as total_sales,\n    count(distinct customer_skey) as total_customers,\n    sum(sales_quantity) as total_items,\nfrom  \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_order_date is not null\ngroup by order_month\norder by order_month)\nSELECT\n    order_month,\n    total_sales,\n    total_customers,\n    total_items,\n    RANK() OVER (ORDER BY total_sales asc) AS sales_rank,\n    RANK() OVER (ORDER BY total_customers asc) AS customer_rank\nFROM monthly_sales\nqualify sales_rank = 1 or customer_rank = 1\nORDER BY sales_rank, customer_rank;\n\n\n-- DATETRUNC() -- month argument gives the first day of the month, year first day of the year\nselect date_trunc('month',current_date);\n\n-- status of total sales, customers and items sold at the beginning of each monthly\nselect\n--     year(sales_order_date) as order_year,\n    date_trunc('month',sales_order_date) as order_month,\n    sum(sales_amount) as total_sales,\n    count(distinct customer_skey) as total_customers,\n    sum(sales_quantity) as total_items,\nfrom  \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_order_date is not null\ngroup by order_month\norder by order_month;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.542788Z", "completed_at": "2025-04-05T20:51:04.547243Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.548016Z", "completed_at": "2025-04-05T20:51:04.548021Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013836145401000977, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.cumulative_analysis", "compiled": true, "compiled_code": "/*\n===============================================================================\nCumulative Analysis\n===============================================================================\nPurpose:\n    - To calculate running totals or moving averages for key metrics.\n    - To track performance over time cumulatively.\n    - Useful for growth analysis or identifying long-term trends.\n\nSQL Functions Used:\n    - Window Functions: SUM() OVER(), AVG() OVER()\n===============================================================================\n*/\n\n-- Calculate the total sales per month \n-- and the running total of sales over time .\nwith monthly_sales as (\nselect\n    date_trunc('month', sales_order_date) as order_month,\n    sum(sales_amount) as total_sales_per_month,\n    round(avg(sales_price),2) as avg_sales_price_per_month\nfrom \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_order_date is not null\ngroup by order_month\n)\nselect\n    order_month,\n    total_sales_per_month,\n    sum(total_sales_per_month) over (partition by order_month order by order_month) as running_total_sales,\n    round(avg(avg_sales_price_per_month) over(partition by order_month order by order_month),2) as moving_avg_month\nfrom monthly_sales\norder by order_month;\n\n-- by year and over time\nwith yearly_sales as (\nselect\n    date_trunc('year', sales_order_date) as order_year,\n    sum(sales_amount) as total_sales_per_year,\n    round(avg(sales_price),2) as avg_sales_price_per_year\nfrom  \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_order_date is not null\ngroup by order_year\n)\nselect\n    order_year,\n    total_sales_per_year,\n    sum(total_sales_per_year) over ( order by order_year) as running_total_sales_year,\n    round(avg(avg_sales_price_per_year) over( order by order_year),2) as moving_avg_year\nfrom yearly_sales\norder by order_year;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.550193Z", "completed_at": "2025-04-05T20:51:04.591742Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.592358Z", "completed_at": "2025-04-05T20:51:04.592367Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.04339909553527832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.date_exploration", "compiled": true, "compiled_code": "ATTACH 'dwh.duckdb' as db1;\n\n-- date exploration\n/*\n===============================================================================\nDate Range Exploration \n===============================================================================\nPurpose:\n    - To determine the temporal boundaries of key data points.\n    - To understand the range of historical data.\n\nSQL Functions Used:\n    - MIN(), MAX(), DATEDIFF()\n===============================================================================\n*/\n\n--find the first and last order date\nselect \n  min(sales_order_date) as first_order_date,\n  max(sales_order_date) as last_order_date\nfrom \"dwh\".\"gold\".\"fact_sales\";\n\n-- find the oldest and youngest customers and their age, difference\nselect \n  min(customer_birthdate) as oldest_customer, \n  date_diff('year', min(customer_birthdate), current_date) as oldest_age,\n  max(customer_birthdate) as youngest_customer,\n  date_diff('year', max(customer_birthdate), current_date) as youngest_age,\n  age(min(customer_birthdate)) as oldest_age1_pg,--, max(customer_birthdate))\n  date_part('year', min(customer_birthdate)) as oldest_year_pg,\n  extract(year from age(max(customer_birthdate),min(customer_birthdate))) as diff_age_pg\n  -- date_part('year', max(customer_birthdate) - min(customer_birthdate)) as youngest_age1\nfrom  \"dwh\".\"gold\".\"dim_customers_current\";\n\n\n-- how many years of sales are available\nselect \n  min(sales_order_date) as first_ord_date,\n  max(sales_order_date) as last_ord_date,\n  date_diff('year', min(sales_order_date),max(sales_order_date)) as order_range_years,\n  date_diff('month', min(sales_order_date),max(sales_order_date)) as order_range_months,\nfrom \"dwh\".\"gold\".\"fact_sales\";", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.589266Z", "completed_at": "2025-04-05T20:51:04.592035Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.592885Z", "completed_at": "2025-04-05T20:51:04.592890Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.04359602928161621, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.dimension_exploration", "compiled": true, "compiled_code": "/*\n===============================================================================\nDimensions Exploration\n===============================================================================\nPurpose:\n    - To explore the structure of dimension tables.\n\t\nSQL Functions Used:\n    - DISTINCT\n    - ORDER BY\n===============================================================================\n*/\n\n-- explore all the main categories of the products\nWITH product_source as (\n    SELECT * FROM \"dwh\".\"gold\".\"dim_products_current\"\n)\nselect distinct product_category, product_subcategory, product_name\nfrom product_source --gold.dim_products\norder by 1,2,3;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.595217Z", "completed_at": "2025-04-05T20:51:04.604559Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.605145Z", "completed_at": "2025-04-05T20:51:04.605151Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011200904846191406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.magnitude_exploration", "compiled": true, "compiled_code": "/*\n===============================================================================\nMagnitude Analysis\n===============================================================================\nPurpose:\n    - To quantify data and group results by specific dimensions.\n    - For understanding data distribution across categories.\n\nSQL Functions Used:\n    - Aggregate Functions: SUM(), COUNT(), AVG()\n    - GROUP BY, ORDER BY\n===============================================================================\n*/\n\n-- Find total customers by countries\nselect\n    --'total_customer_per_country' as measure_name,\n    customer_country,\n    count(customer_skey) as total_customer_by_country\nfrom \"dwh\".\"gold\".\"dim_customers_current\" -- gold.dim_customers\ngroup by customer_country\norder by total_customer_by_country desc;\n\n/*\ncustomer_country,total_customer_by_country\nUnited States,7482\nAustralia,3591\nUnited Kingdom,1913\nFrance,1810\nGermany,1780\nCanada,1571\nn/a,337\n */\n\n-- Find total customers by gender per country\nselect\n    customer_gender, customer_country,\n    count(customer_skey) as total_customer_by_gender_country\nfrom \"dwh\".\"gold\".\"dim_customers_current\"--gold.dim_customers\ngroup by customer_gender, customer_country\norder by total_customer_by_gender_country desc;\n\n/*\n customer_gender,customer_country,total_customer_by_gender_country\nMale,United States,3757\nFemale,United States,3724\nMale,Australia,1814\nFemale,Australia,1777\nMale,United Kingdom,977\nFemale,United Kingdom,932\nMale,France,913\nMale,Germany,903\nFemale,France,891\nFemale,Germany,873\nMale,Canada,804\nFemale,Canada,767\nMale,n/a,173\nFemale,n/a,164\nn/a,France,6\nn/a,United Kingdom,4\nn/a,Germany,4\nn/a,United States,1\n */\n\n-- Find total products by category\nselect\n    product_category,\n    count(product_skey) as total_products_by_category\nfrom \"dwh\".\"gold\".\"dim_products_current\"--gold.dim_products\ngroup by product_category\norder by total_products_by_category desc;\n\n/*\n product_category,total_products_by_category\nComponents,127\nBikes,97\nClothing,35\nAccessories,29\nnull,7\n */\n-- What is the average costs in each category?\nselect\n    product_category,\n    round(avg(product_cost),2) as avg_product_cost\n    --count(product_skey) as total_products_by_category\nfrom \"dwh\".\"gold\".\"dim_products_current\" --gold.dim_products\ngroup by product_category\norder by avg_product_cost desc;\n\n-- What is the total revenue generated for each category?\nSelect\n    dp.product_category,\n    avg(dp.product_cost) as avg_product_cost_per_category,\n    sum(fs.sales_amount) as total_revenue_per_category\nfrom \"dwh\".\"gold\".\"fact_sales\" --gold.fact_sales fs\nleft join \"dwh\".\"gold\".\"dim_products_current\" dp on fs.product_skey=dp.product_skey\ngroup by dp.product_category\norder by total_revenue_per_category desc;\n\n/*\n product_category,avg_product_cost_per_category,total_revenue_per_category\nBikes,1131.6479447550148,28316272\nAccessories,7.222015959215339,700262\nClothing,22.29271508625426,339716\n */\n\n-- What is the total revenue generated by each customer?\nSelect\n    dc.customer_key,\n    sum(fs.sales_amount) as top_10_customers\nfrom \"dwh\".\"gold\".\"fact_sales\" fs\nleft join \"dwh\".\"gold\".\"dim_customers_current\" dc on fs.customer_skey=dc.customer_skey\ngroup by dc.customer_key\norder by top_10_customers desc\nlimit 10;\n\n/*\ncustomer_key,total_revenue_per_customer\nAW00012301,13294\nAW00012132,13294\nAW00012308,13268\nAW00012131,13265\nAW00012300,13242\nAW00012321,13215\nAW00012124,13195\nAW00012307,13172\nAW00012296,13164\nAW00011433,12914\n\n */\n\n-- What is the distribution of sold items across countries?\nSelect\n    dc.customer_country,\n    --dp.product_name,\n    sum(fs.sales_quantity) as total_sold_items\nfrom \"dwh\".\"gold\".\"fact_sales\" fs\nleft join \"dwh\".\"gold\".\"dim_customers_current\" dc on fs.customer_skey=dc.customer_skey\nleft join \"dwh\".\"gold\".\"dim_products_current\" dp on fs.product_skey=dp.product_skey\ngroup by dc.customer_country--,dp.product_name\norder by total_sold_items desc;\n\n/*\n customer_country,total_sold_items\nUnited States,20481\nAustralia,13346\nCanada,7630\nUnited Kingdom,6910\nGermany,5626\nFrance,5559\nn/a,871\n\n */", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.600022Z", "completed_at": "2025-04-05T20:51:04.604835Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.605624Z", "completed_at": "2025-04-05T20:51:04.605628Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01135706901550293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.measures_exploration", "compiled": true, "compiled_code": "/*\n===============================================================================\nMeasures Exploration (Key Metrics)\n===============================================================================\nPurpose:\n    - To calculate aggregated metrics (e.g., totals, averages) for quick insights.\n    - To identify overall trends or spot anomalies.\n\nSQL Functions Used:\n    - COUNT(), SUM(), AVG()\n===============================================================================\n*/\n\n-- Find the Total Sales\n\nselect\n    sum(sales_amount) as total_sales\nfrom \"dwh\".\"gold\".\"fact_sales\"; -- 29,356,250\n\n-- Find how many items are sold\nselect\n    sum(sales_quantity) as total_items_sold\nfrom \"dwh\".\"gold\".\"fact_sales\"; --60423\n\n-- Find the average selling price\nselect\n    round(avg(sales_price),2) as avg_sale_price\nfrom \"dwh\".\"gold\".\"fact_sales\"; -- 486.04\n\n-- Find the Total number of Orders\nselect\n    count(distinct sales_order_number) as total_orders\nfrom \"dwh\".\"gold\".\"fact_sales\"; --27659\n\n-- Find the total number of products\nselect\n    count( product_key) as total_products\nfrom \"dwh\".\"gold\".\"dim_products_current\"; -- 295\nselect\n    count( distinct product_skey) as total_products\nfrom \"dwh\".\"gold\".\"fact_sales\"; --130\n\n-- Find the total number of customers\nselect\n    count(customer_skey) as total_customers\nfrom \"dwh\".\"gold\".\"dim_customers_current\"; --18484\n\n-- Find the total number of customers that has placed an order\nselect\n    count( distinct customer_skey) as total_customers\nfrom \"dwh\".\"gold\".\"fact_sales\"; --18484\n\n\n\n-- Generate a comprehensive business metrics \nwith customer_source as (\n    Select * from \"dwh\".\"gold\".\"dim_customers_current\"\n),\nproducts_source as (\n    Select * from \"dwh\".\"gold\".\"dim_products_current\"\n),\nsales_source as (\n    Select * from \"dwh\".\"gold\".\"fact_sales\"\n),\nsales_metrics as (\n    select\n        sum(sales_amount) as total_sales,\n        sum(sales_quantity) as total_items_sold,\n        round(avg(sales_price),2) as avg_sale_price,\n        count(distinct sales_order_number) as total_orders\n    from sales_source\n),\nproduct_metrics as (\n    select \n        count(product_key) as total_products\n    from products_source\n),\ncustomer_metrics as (\n    select \n        count(customer_skey) as total_customers,\n        (select count(distinct customer_skey) from sales_source) as total_ordered_customers\n    from customer_source\n),\nbusiness_metrics as (\n    select 'total_sales' as measure_name, total_sales as measure_value from sales_metrics\n    UNION ALL\n    select 'total_items_sold', total_items_sold from sales_metrics\n    UNION ALL\n    select 'avg_sale_price', avg_sale_price from sales_metrics\n    UNION ALL\n    select 'total_orders', total_orders from sales_metrics\n    UNION ALL\n    select 'total_products', total_products from product_metrics\n    UNION ALL\n    select 'total_customer', total_customers from customer_metrics\n    UNION ALL\n    select 'total_ordered_customer', total_ordered_customers from customer_metrics\n)\nselect * from business_metrics;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.607918Z", "completed_at": "2025-04-05T20:51:04.613773Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.614324Z", "completed_at": "2025-04-05T20:51:04.614329Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007686138153076172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.part_to_whole_analysis", "compiled": true, "compiled_code": "/*\n===============================================================================\nPart-to-Whole Analysis\n===============================================================================\nPurpose:\n    - To compare performance or metrics across dimensions or time periods.\n    - To evaluate differences between categories.\n    - Useful for A/B testing or regional comparisons.\n\nSQL Functions Used:\n    - SUM(), AVG(): Aggregates values for comparison.\n    - Window Functions: SUM() OVER() for total calculations.\n===============================================================================\n*/\n-- Which categories contribute the most to overall sales and overall orders?\nwith category_sales_orders as (\nselect\n    dp.product_category,\n    sum(fs.sales_amount) as total_sales,\n    count(fs.sales_order_number) as total_orders\nfrom \"dwh\".\"gold\".\"fact_sales\" fs\nleft join \"dwh\".\"gold\".\"dim_products_current\" dp on fs.product_skey = dp.product_skey\ngroup by dp.product_category\n),\noverall_calc as (\nselect *,\n       sum(total_sales) over() as overall_sales,\n       sum(total_orders) over() as overall_orders\nfrom category_sales_orders\n)\nselect *,\n       concat(round((total_sales::float/overall_sales)*100,2) , '%') as percentage_of_total,\n       concat(round((total_orders::float/overall_orders)*100,2) , '%') as percentage_of_orders\nfrom overall_calc\norder by total_sales desc;\n\n-- bikes contributes more to sales even if it is only 25% of the order.\n--    accessories have the highest order percentage buy brings in only 2.3% of the revenue.", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.610438Z", "completed_at": "2025-04-05T20:51:04.614040Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.614783Z", "completed_at": "2025-04-05T20:51:04.614787Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00780177116394043, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.performance_analysis", "compiled": true, "compiled_code": "/*\n===============================================================================\nPerformance Analysis (Year-over-Year, Month-over-Month)\n===============================================================================\nPurpose:\n    - To measure the performance of products, customers, or regions over time.\n    - For benchmarking and identifying high-performing entities.\n    - To track yearly trends and growth.\n\nSQL Functions Used:\n    - LAG(): Accesses data from previous rows.\n    - AVG() OVER(): Computes average values within partitions.\n    - CASE: Defines conditional logic for trend analysis.\n===============================================================================\n*/\n\n/* Analyze the yearly performance of products by comparing their sales \nto both the average sales performance of the product and the previous year's sales */\n\nwith yearly_sales as (\nselect\n    date_part('year', sales_order_date) as order_year,\n    dp.product_name,\n    sum(fs.sales_amount) as current_sales\nfrom \"dwh\".\"gold\".\"fact_sales\" fs\nleft join \"dwh\".\"gold\".\"dim_products_current\" dp on fs.product_skey = dp.product_skey\nwhere fs.sales_order_date is not null\ngroup by order_year, dp.product_name\norder by order_year\n),\navg_prev_sales as (select\n    order_year,\n    product_name,\n    current_sales,\n    avg(current_sales) over(partition by product_name) as avg_sales,\n    lag(current_sales) over(partition by product_name order by order_year) as prev_sales\nfrom yearly_sales\norder by product_name,order_year)\nselect\n    *,\n    current_sales - avg_sales as sales_avg_diff,\n    case\n        when (current_sales - avg_sales) > 0 then 'above average'\n        when (current_sales - avg_sales) < 0 then 'below average'\n        else 'average'\n    end as avg_sales_change,\n    current_sales - prev_sales as sales_diff,\n    case\n        when (current_sales - prev_sales) > 0 then 'increase'\n        when (current_sales - prev_sales) < 0 then 'decrease'\n        else 'no change'\n    end as prev_sales_change\nfrom avg_prev_sales;\n\n--month-to-month analysis\nwith monthly_sales as (\nselect\n    date_part('month', sales_order_date) as order_month,\n    dp.product_name,\n    sum(fs.sales_amount) as current_sales\nfrom \"dwh\".\"gold\".\"fact_sales\" fs\nleft join \"dwh\".\"gold\".\"dim_products_current\" dp on fs.product_skey = dp.product_skey\nwhere fs.sales_order_date is not null\ngroup by order_month, dp.product_name\norder by order_month\n),\navg_prev_sales as (select\n    order_month,\n    product_name,\n    current_sales,\n    avg(current_sales) over(partition by product_name) as avg_sales,\n    lag(current_sales) over(partition by product_name order by order_month) as prev_sales\nfrom monthly_sales\norder by product_name,order_month)\nselect\n    *,\n    current_sales - avg_sales as sales_avg_diff,\n    case\n        when (current_sales - avg_sales) > 0 then 'above average'\n        when (current_sales - avg_sales) < 0 then 'below average'\n        else 'average'\n    end as avg_sales_change,\n    current_sales - prev_sales as sales_diff,\n    case\n        when (current_sales - prev_sales) > 0 then 'increase'\n        when (current_sales - prev_sales) < 0 then 'decrease'\n        else 'no change'\n    end as prev_sales_change\nfrom avg_prev_sales;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.617033Z", "completed_at": "2025-04-05T20:51:04.624508Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.624840Z", "completed_at": "2025-04-05T20:51:04.624845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00902700424194336, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.ranking_exploration", "compiled": true, "compiled_code": "/*\n===============================================================================\nRanking Analysis\n===============================================================================\nPurpose:\n    - To rank items (e.g., products, customers) based on performance or other metrics.\n    - To identify top performers or laggards.\n\nSQL Functions Used:\n    - Window Ranking Functions: RANK(), DENSE_RANK(), ROW_NUMBER(), TOP\n    - Clauses: GROUP BY, ORDER BY\n===============================================================================\n*/\n\n\n-- Ranking Analysis\n\n-- Which top 5 products Generating the Highest Revenue?\nselect\n    dp.product_key,\n    dp.product_name,\n    dp.product_category,\n    sum(fs.sales_amount) as total_sales_per_product\nfrom \"dwh\".\"gold\".\"fact_sales\" fs\nleft join \"dwh\".\"gold\".\"dim_products_current\" dp on fs.product_skey = dp.product_skey\ngroup by dp.product_key, dp.product_name, dp.product_category\norder by total_sales_per_product desc\nlimit 5;\n\n/*\n product_key,product_name,product_category,total_sales_per_product\nBK-M68B-46,Mountain-200 Black- 46,Bikes,1373454\nBK-M68B-42,Mountain-200 Black- 42,Bikes,1363128\nBK-M68S-38,Mountain-200 Silver- 38,Bikes,1339394\nBK-M68S-46,Mountain-200 Silver- 46,Bikes,1301029\nBK-M68B-38,Mountain-200 Black- 38,Bikes,1294854\n\n */\n\n-- Complex but Flexibly Ranking Using Window Functions\nwith product_revenue as (\n    SELECT\n        dp.product_name,\n        sum(fs.sales_amount) as total_sales_per_product\n    from \"dwh\".\"gold\".\"fact_sales\" fs\n    left join \"dwh\".\"gold\".\"dim_products_current\" dp on fs.product_skey = dp.product_skey\n    group by dp.product_name\n),\nranked_products as (\n    select\n        product_name,\n        total_sales_per_product,\n        rank() over(order by total_sales_per_product desc) as ranked_products\n    from product_revenue\n)\nselect *\nfrom ranked_products\nwhere ranked_products <=5;\n/*\nproduct_name,total_sales_per_product,ranked_products\nMountain-200 Black- 46,1373454,1\nMountain-200 Black- 42,1363128,2\nMountain-200 Silver- 38,1339394,3\nMountain-200 Silver- 46,1301029,4\nMountain-200 Black- 38,1294854,5\n*/\n\n-- What are the 5 worst-performing products in terms of sales?\nwith product_revenue as (\n    SELECT\n        dp.product_name,\n        sum(fs.sales_amount) as total_sales_per_product,\n        rank() over (order by sum(fs.sales_amount) desc) as rank_products\n    from \"dwh\".\"gold\".\"fact_sales\" fs\n    left join \"dwh\".\"gold\".\"dim_products_current\" dp on fs.product_skey = dp.product_skey\n    group by dp.product_name\n)\nselect *\nfrom product_revenue\nwhere rank_products<=5;\n\n\n/*\n product_name,total_sales_per_product,ranked_products\nRacing Socks- L,2430,1\nRacing Socks- M,2682,2\nPatch Kit/8 Patches,6382,3\nBike Wash - Dissolver,7272,4\nTouring Tire Tube,7440,5\n\n */\n\n-- Find the top 10 customers who have generated the highest revenue\nselect dc.customer_key ,dc.customer_firstname, dc.customer_lastname,\n       sum(fs.sales_amount) as total_revenue,\n       dense_rank() over(order by sum(fs.sales_amount) desc) as ranked_customers_d,\n        --rank() over(order by sum(fs.sales_amount) desc) as ranked_customers_r,\nfrom \"dwh\".\"gold\".\"fact_sales\" fs\nleft join \"dwh\".\"gold\".\"dim_customers_current\" dc on fs.customer_skey = dc.customer_skey\ngroup by dc.customer_key, dc.customer_firstname, dc.customer_lastname\nqualify ranked_customers_d <=10;\n\n\n-- The 3 customers with the fewest orders placed\nwith cte_ as (\n    select  dc.customer_id ,dc.customer_firstname, dc.customer_lastname, count(distinct fs.sales_order_number) as total_orders\nfrom \"dwh\".\"gold\".\"fact_sales\" fs\nleft join \"dwh\".\"gold\".\"dim_customers_current\" dc on fs.customer_skey = dc.customer_skey\ngroup by dc.customer_id , dc.customer_firstname, dc.customer_lastname\norder by  total_orders\n)\nselect * from cte_\nlimit 3;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.621394Z", "completed_at": "2025-04-05T20:51:04.625622Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.626293Z", "completed_at": "2025-04-05T20:51:04.626296Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010168075561523438, "adapter_response": {}, "message": null, "failures": null, "unique_id": "analysis.dbt_transform.segmentation_analysis", "compiled": true, "compiled_code": "/*\n===============================================================================\nData Segmentation Analysis\n===============================================================================\nPurpose:\n    - To group data into meaningful categories for targeted insights.\n    - For customer segmentation, product categorization, or regional analysis.\n\nSQL Functions Used:\n    - CASE: Defines custom segmentation logic.\n    - GROUP BY: Groups data into segments.\n===============================================================================\n*/\n\n/*Segment products into cost ranges and \ncount how many products fall into each segment*/\n\nwith product_segments as (\nSELECT\n    product_name,\n    product_key,\n    product_category,\n    product_cost,\n    CASE\n        WHEN product_cost < 100 then 'BELOW 100'\n        WHEN product_cost between 100 and 500 then '100-500'\n        WHEN product_cost between 500  and 1000 then '500-1000'\n        ELSE 'above 1000'\n    END  as product_cost_range\nfrom \"dwh\".\"gold\".\"dim_products_current\"\n)\nselect\n    product_cost_range,\n    count(product_key) as total_products\nfrom product_segments\ngroup by product_cost_range\norder by total_products desc;\n\n\n/*Group customers into three segments based on their spending behavior:\n\t- VIP: Customers with at least 12 months of history and spending more than \u20ac5,000.\n\t- Regular: Customers with at least 12 months of history but spending \u20ac5,000 or less.\n\t- New: Customers with a lifespan less than 12 months.\nAnd find the total number of customers by each group\n*/\n\n\nWITH customer_spending as (\n    SELECT\n    dc.customer_key,\n    sum(fs.sales_amount) as total_spending,\n    min(sales_order_date) as first_order,\n    max(sales_order_date) as last_order,\n    datediff('month', min(sales_order_date), max(sales_order_date) ) as lifespan\n    from \"dwh\".\"gold\".\"fact_sales\" fs\n    left join \"dwh\".\"gold\".\"dim_customers_current\"  dc on fs.customer_skey = dc.customer_skey\ngroup by dc.customer_key\n),\ncustomer_seg as (\nselect\n    *,\n    CASE\n        WHEN lifespan >=12 AND total_spending > 5000 then 'VIP'\n        WHEN lifespan >=12 AND total_spending <= 5000 then 'Regular'\n        ELSE 'NEW'\n    END as customer_status\nfrom customer_spending\n)\nselect\n    customer_status,\n    count(customer_key) as total_customers\nfrom customer_seg\ngroup by customer_status\norder by  total_customers desc;", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.627347Z", "completed_at": "2025-04-05T20:51:04.636132Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.636448Z", "completed_at": "2025-04-05T20:51:04.636453Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010549068450927734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.bz_crm_cust_info", "compiled": true, "compiled_code": "\nWITH deduped AS (\n    SELECT \n        cst_id,\n        cst_key,\n        cst_firstname,\n        cst_lastname,\n        cst_marital_status,\n        cst_gndr,\n        cst_create_date,\n        CASE \n            WHEN COALESCE(unaccent(email), 'unknown') = 'unknown' THEN 'unknown'\n            ELSE REGEXP_REPLACE(\n                LOWER(\n                    -- Remove spaces in the local part (before @)\n                    REGEXP_REPLACE(\n                        COALESCE(unaccent(email), 'unknown'),\n                        '([^@]+)( )([^@]*@.*)',\n                        '\\1.\\3'\n                    )\n                ),\n                ' ',\n                '.'\n            )\n        END AS cst_email, -- schema evolution\n        COALESCE(place_of_residence, NULL) AS cst_place,\n        COALESCE(postal_code, NULL) AS cst_postal_code,\n        ingested_at,\n        ROW_NUMBER() OVER (PARTITION BY cst_id ORDER BY ingested_at DESC, cst_create_date DESC) AS rn\n    FROM \"sql_dwh_db\".\"raw\".\"raw_crm_cust_info\"\n    WHERE cst_id IS NOT NULL\n)\nSELECT \n    *,\n    CURRENT_TIMESTAMP::TIMESTAMP AS updated_at -- for snapshot tracking. Typecasting to avoid timezone\nFROM deduped\nWHERE rn = 1\n", "relation_name": "\"dwh\".\"bronze\".\"bz_crm_cust_info\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.633448Z", "completed_at": "2025-04-05T20:51:04.637295Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.638022Z", "completed_at": "2025-04-05T20:51:04.638026Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00532078742980957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.bz_crm_prd_info", "compiled": true, "compiled_code": "\n\nWITH source AS (\n    SELECT \n        prd_id,\n        prd_key,\n        prd_nm,\n        COALESCE(prd_cost, 0) AS prd_cost,  -- Schema evolution\n        prd_line,\n        prd_start_dt,\n        prd_end_dt,\n        ingested_at,\n        CURRENT_TIMESTAMP::TIMESTAMP AS updated_at -- for snapshot tracking\n    FROM \"sql_dwh_db\".\"raw\".\"raw_crm_prd_info\"\n    WHERE prd_id IS NOT NULL\n)\nSELECT \n    *\nFROM source\n", "relation_name": "\"dwh\".\"bronze\".\"bz_crm_prd_info\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.639127Z", "completed_at": "2025-04-05T20:51:04.646934Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.647294Z", "completed_at": "2025-04-05T20:51:04.647299Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009662151336669922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.bz_crm_sales_details", "compiled": true, "compiled_code": "\nWITH source AS (\nSELECT\n    sls_ord_num,\n    sls_prd_key,\n    sls_cust_id,\n    CASE \n        WHEN sls_order_dt::VARCHAR ~ '^[0-9]{8}$' \n        THEN TO_DATE(sls_order_dt::VARCHAR, 'YYYYMMDD')\n        ELSE NULL\n    END AS sls_order_dt,\n    CASE \n        WHEN sls_ship_dt::VARCHAR ~ '^[0-9]{8}$' \n        THEN TO_DATE(sls_ship_dt::VARCHAR, 'YYYYMMDD')\n        ELSE NULL\n    END AS sls_ship_dt,\n    CASE \n        WHEN sls_due_dt::VARCHAR ~ '^[0-9]{8}$' \n        THEN TO_DATE(sls_due_dt::VARCHAR, 'YYYYMMDD')\n        ELSE NULL\n    END AS sls_due_dt,\n    sls_sales,\n    sls_quantity,\n    sls_price,\n    ingested_at,\n    CURRENT_TIMESTAMP AS updated_at -- for snapshot tracking\n    FROM \"sql_dwh_db\".\"raw\".\"raw_crm_sales_details\"\n)\nSELECT \n    *\nFROM source\n", "relation_name": "\"dwh\".\"bronze\".\"bz_crm_sales_details\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.644236Z", "completed_at": "2025-04-05T20:51:04.648271Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.648863Z", "completed_at": "2025-04-05T20:51:04.648866Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00543212890625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.bz_erp_cust_az12", "compiled": true, "compiled_code": "\nWITH source AS (\n    SELECT \n        *,--(has ingested_at for incremental filtering)\n        CURRENT_TIMESTAMP::TIMESTAMP AS updated_at -- for snapshot tracking\n    FROM \"sql_dwh_db\".\"raw\".\"raw_erp_cust_az12\"\n    WHERE cid IS NOT NULL  -- Basic validation\n)\nSELECT \n    *\nFROM source\n", "relation_name": "\"dwh\".\"bronze\".\"bz_erp_cust_az12\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.649951Z", "completed_at": "2025-04-05T20:51:04.656141Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.656446Z", "completed_at": "2025-04-05T20:51:04.656450Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007961034774780273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.bz_erp_loc_a101", "compiled": true, "compiled_code": "\nWITH source AS (\n    SELECT \n        *,--(has ingested_at for incremental filtering)\n        CURRENT_TIMESTAMP::TIMESTAMP AS updated_at -- for snapshot tracking\n    FROM \"sql_dwh_db\".\"raw\".\"raw_erp_loc_a101\"\n)\nSELECT \n    *\nFROM source\n", "relation_name": "\"dwh\".\"bronze\".\"bz_erp_loc_a101\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.653271Z", "completed_at": "2025-04-05T20:51:04.656893Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.657592Z", "completed_at": "2025-04-05T20:51:04.657596Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005109071731567383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.bz_erp_px_cat_g1v2", "compiled": true, "compiled_code": "\nWITH source AS (\n    SELECT \n        *,--(has ingested_at for incremental filtering)\n        CURRENT_TIMESTAMP::TIMESTAMP AS updated_at -- for snapshot tracking\n    FROM \"sql_dwh_db\".\"raw\".\"raw_erp_px_cat_g1v2\"\n)\nSELECT \n    *\nFROM source\n", "relation_name": "\"dwh\".\"bronze\".\"bz_erp_px_cat_g1v2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.668323Z", "completed_at": "2025-04-05T20:51:04.672196Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.672509Z", "completed_at": "2025-04-05T20:51:04.672514Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013534069061279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.report_customers", "compiled": true, "compiled_code": "/*\n===============================================================================\nCustomer Report\n===============================================================================\nPurpose:\n    - This report consolidates key customer metrics and behaviors\n\nHighlights:\n    1. Gathers essential fields such as names, ages, and transaction details.\n\t2. Segments customers into categories (VIP, Regular, New) and age groups.\n    3. Aggregates customer-level metrics:\n\t   - total orders\n\t   - total sales\n\t   - total quantity purchased\n\t   - total products\n\t   - lifespan (in months)\n    4. Calculates valuable KPIs:\n\t    - recency (months since last order. Use '2015-01-01' as current_date)\n\t\t- average order value\n\t\t- average monthly spend\n===============================================================================\n*/\n\n\nWITH dim_customers_table AS (\n    SELECT *\n    FROM \"dwh\".\"gold\".\"dim_customers_current\"\n),\nfact_sales_table as (\n    SELECT *\n    FROM \"dwh\".\"gold\".\"fact_sales\"\n), \ncustomer_base_query as(\n    SELECT\n        CONCAT(dc.customer_firstname, ' ', dc.customer_lastname) as customer_name,\n        dc.customer_key,\n        dc.customer_birthdate,\n        dc.customer_gender,\n        dc.customer_country,\n        dc.customer_marital_status,\n        date_diff('year', dc.customer_birthdate, current_date()) as age_in_years,\n        customer_email,\n        customer_place,\n        customer_postal_code,\n        fs.product_key,\n        fs.sales_order_number,\n        fs.sales_order_date,\n        fs.sales_amount,\n        fs.sales_quantity\n    from fact_sales_table fs\n    left join dim_customers_table dc on fs.customer_key = dc.customer_key\n    -- where fs.sales_order_date is not null\n),\ncustomer_agg as (\n    select\n        row(customer_name,\n            customer_key,\n            age_in_years,\n            customer_birthdate,\n            customer_gender,\n            customer_country,\n            customer_marital_status,\n            customer_email,\n            customer_place,\n            customer_postal_code)::analytics.customer_bio_struct\n        as customer_bio,\n        sum(sales_amount) as total_spending,\n        count(distinct sales_order_number) as total_orders,\n        sum(sales_quantity) as total_quantity,\n        COUNT(DISTINCT product_key) AS total_products,\n\t    MAX(sales_order_date) AS last_order_date,\n\t    date_diff('month', MIN(sales_order_date), MAX(sales_order_date)) AS lifespan_in_months\n    from customer_base_query\n    group by all\n)\nselect\n    customer_bio,\n    CASE\n        WHEN customer_bio.customer_age < 20 THEN 'LESS THAN 20'\n        WHEN customer_bio.customer_age BETWEEN 20 and 29 THEN '20-29'\n        WHEN customer_bio.customer_age BETWEEN 30 and 39 THEN '30-39'\n        WHEN customer_bio.customer_age BETWEEN 40 and 49 THEN '40-49'\n        WHEN customer_bio.customer_age BETWEEN 50 and 59 THEN '50-59'\n        ELSE 'Above 60'\n    END as age_group,\n    lifespan_in_months,\n    CASE\n        WHEN lifespan_in_months >=12 AND total_spending > 5000 then 'VIP'\n        WHEN lifespan_in_months >=12 AND total_spending <= 5000 then 'Regular'\n        ELSE 'NEW'\n    END as customer_status,\n    last_order_date,\n    date_diff('month', last_order_date, '2015-01-01'::DATE) as recency_in_months,\n    CASE\n        WHEN recency_in_months BETWEEN 0 and 3 THEN 'Recently active'\n        WHEN recency_in_months BETWEEN 4 and 10 THEN 'Moderately active'\n        WHEN recency_in_months BETWEEN 11 and 24 THEN 'Rarely active'\n        ELSE 'Potentially inactive'\n    END AS recency_status,\n    total_orders,\n    total_products,\n    total_quantity,\n    total_spending,\n    -- Compute average order value (AVO)\n    COALESCE(total_spending/NULLIF(total_orders,0),0)::DECIMAL as avg_order_value,\n    -- compute average monthly spend\n    COALESCE(total_spending/NULLIF(lifespan_in_months,0),total_orders)::DECIMAL as avg_monthly_spend,\nfrom customer_agg", "relation_name": "\"dwh\".\"analytics\".\"report_customers\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.673955Z", "completed_at": "2025-04-05T20:51:04.677307Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.677601Z", "completed_at": "2025-04-05T20:51:04.677605Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0043451786041259766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.report_products", "compiled": true, "compiled_code": "/*\n===============================================================================\nProduct Report\n===============================================================================\nPurpose:\n    - This report consolidates key product metrics and behaviors.\n\nHighlights:\n    1. Gathers essential fields such as product name, category, subcategory, and cost.\n    2. Segments products by revenue to identify High-Performers, Mid-Range, or Low-Performers.\n    3. Aggregates product-level metrics:\n       - total orders\n       - total sales\n       - total quantity sold\n       - total customers (unique)\n       - lifespan (in months)\n    4. Calculates valuable KPIs:\n       - recency (months since last sale. use '2015-01-01' as current_date)\n       - average order revenue (AOR)\n       - average monthly revenue\n===============================================================================\n*/\n\n\nWITH dim_products_table AS (\n    SELECT *\n    FROM  \"dwh\".\"gold\".\"dim_products_current\"\n),\nfact_sales_table as (\n    SELECT *\n    FROM \"dwh\".\"gold\".\"fact_sales\"\n),\nproduct_base_query AS (\n    SELECT\n        dp.product_key,\n        dp.product_code,\n        dp.product_name,\n        dp.product_cost,\n        dp.product_category,\n        dp.product_subcategory,\n        dp.product_maintenance_status,\n        fs.sales_order_date,\n        fs.sales_quantity,\n        fs.sales_order_number,\n        fs.sales_amount,\n        fs.customer_key\n    FROM fact_sales_table fs\n    left join dim_products_table dp on fs.product_key = dp.product_key\n),\nproduct_agg AS (\n    SELECT\n        row(\n            product_key,\n            product_code,\n            product_name,\n            product_cost,\n            product_category,\n            product_subcategory,\n            product_maintenance_status\n        )::analytics.product_struct\n        AS product_info,\n        sum(sales_amount) as total_sales,\n        count(distinct sales_order_number) as total_orders,\n        count(distinct customer_key) as total_customers,\n        max(sales_order_date) as last_sale_date,\n        date_diff('month', min(sales_order_date), max(sales_order_date)) as lifespan_in_month,\n        avg(COALESCE(sales_amount/NULLIF(sales_quantity,0),0))::DECIMAL as avg_selling_price\n    from product_base_query\n    group by all\n)\nSELECT\n    *,\n    date_diff('month', last_sale_date, '2015-01-01'::DATE) AS recency_in_months,\n    CASE\n        WHEN recency_in_months BETWEEN 0 and 5 THEN 'Recently active'\n        WHEN recency_in_months BETWEEN 6 and 12 THEN 'Moderately active'\n        WHEN recency_in_months BETWEEN 13 and 24 THEN 'Possibly stagnate'\n        ELSE 'Potentially discontinued/dormant'\n    END AS recency_status,\n\tCASE\n\t\tWHEN total_sales > 50_000 THEN 'High-Performer'\n\t\tWHEN total_sales BETWEEN 10_000 AND 50_000 THEN 'Mid-Range'\n\t\tELSE 'Low-Performer'\n\tEND AS product_status,\n    -- Average Order Revenue (AOR)\n\tCOALESCE(total_sales/NULLIF(total_orders,0), 0)::DECIMAL as avg_order_revenue,\n\t-- Average Monthly Revenue\n    COALESCE(total_sales/NULLIF(lifespan_in_month,0), total_sales)::DECIMAL as avg_monthly_revenue\nFROM product_agg", "relation_name": "\"dwh\".\"analytics\".\"report_products\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.679020Z", "completed_at": "2025-04-05T20:51:04.685366Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.686069Z", "completed_at": "2025-04-05T20:51:04.686079Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007961273193359375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.crm_cust_info", "compiled": true, "compiled_code": "\nWITH source AS (\n    SELECT \n        *\n    FROM \"dwh\".\"bronze\".\"bz_crm_cust_info\"\n),\ncleaned_customer AS (\n    SELECT\n        cst_id,\n        cst_key AS cst_code,\n        TRIM(cst_firstname) AS cst_firstname,\n        TRIM(cst_lastname) AS cst_lastname,\n        CASE\n            WHEN UPPER(TRIM(cst_marital_status)) = 'M' THEN 'Married'\n            WHEN UPPER(TRIM(cst_marital_status)) = 'S' THEN 'Single'\n            ELSE 'n/a'\n        END AS cst_marital_status,\n        CASE\n            WHEN UPPER(TRIM(cst_gndr)) = 'M' THEN 'Male'\n            WHEN UPPER(TRIM(cst_gndr)) = 'F' THEN 'Female'\n            ELSE 'n/a'\n        END AS cst_gndr,\n        cst_create_date::DATE as cst_create_date,\n        COALESCE(TRIM(cst_email), 'unknown') AS cst_email,\n        COALESCE(cst_place, 'unknown') AS cst_place,\n        COALESCE(TRIM(CAST(cst_postal_code AS VARCHAR)), 'unknown') AS cst_postal_code,\n        ingested_at,\n        updated_at\n    FROM\n        source\n)\nSELECT\n    *\nFROM\n    cleaned_customer\n\n", "relation_name": "\"dwh\".\"silver\".\"crm_cust_info\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.688973Z", "completed_at": "2025-04-05T20:51:04.705793Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.706486Z", "completed_at": "2025-04-05T20:51:04.706497Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01886296272277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.email_check_bz_crm_cust_info_cst_email.7f2c4cbb21", "compiled": true, "compiled_code": "\nSELECT \n    *\nFROM \"dwh\".\"bronze\".\"bz_crm_cust_info\"\nWHERE \n    cst_email IS NOT NULL\n    AND cst_email != 'unknown'\n    AND cst_email !~ '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$'\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.710026Z", "completed_at": "2025-04-05T20:51:04.725374Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.725720Z", "completed_at": "2025-04-05T20:51:04.725726Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.017146825790405273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_cust_info_cst_create_date.909692acce", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cst_create_date\nfrom \"dwh\".\"bronze\".\"bz_crm_cust_info\"\nwhere cst_create_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.727315Z", "completed_at": "2025-04-05T20:51:04.731517Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.731859Z", "completed_at": "2025-04-05T20:51:04.731865Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005296945571899414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_cust_info_cst_id.aa1840220b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cst_id\nfrom \"dwh\".\"bronze\".\"bz_crm_cust_info\"\nwhere cst_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.733456Z", "completed_at": "2025-04-05T20:51:04.737295Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.737642Z", "completed_at": "2025-04-05T20:51:04.737648Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004929065704345703, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_cust_info_cst_key.6fe1d2bf24", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cst_key\nfrom \"dwh\".\"bronze\".\"bz_crm_cust_info\"\nwhere cst_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.739212Z", "completed_at": "2025-04-05T20:51:04.743922Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.744346Z", "completed_at": "2025-04-05T20:51:04.744352Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005877971649169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_cust_info_ingested_at.4d159ceaac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"bronze\".\"bz_crm_cust_info\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.746033Z", "completed_at": "2025-04-05T20:51:04.750263Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.750653Z", "completed_at": "2025-04-05T20:51:04.750659Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0054128170013427734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_cust_info_updated_at.f4d174cd12", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"bronze\".\"bz_crm_cust_info\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.752269Z", "completed_at": "2025-04-05T20:51:04.758142Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.758478Z", "completed_at": "2025-04-05T20:51:04.758483Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006963253021240234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_bz_crm_cust_info_cst_email.28870d8715", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cst_email as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"bronze\".\"bz_crm_cust_info\"\nwhere cst_email is not null\ngroup by cst_email\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.760104Z", "completed_at": "2025-04-05T20:51:04.763556Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.763891Z", "completed_at": "2025-04-05T20:51:04.763895Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004587888717651367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_bz_crm_cust_info_cst_id.a9d22060cc", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cst_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"bronze\".\"bz_crm_cust_info\"\nwhere cst_id is not null\ngroup by cst_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.765421Z", "completed_at": "2025-04-05T20:51:04.768815Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.769130Z", "completed_at": "2025-04-05T20:51:04.769134Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0044291019439697266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.crm_prd_info", "compiled": true, "compiled_code": "\n\nWITH source_table AS (\n    SELECT \n        *\n    FROM \"dwh\".\"bronze\".\"bz_crm_prd_info\"\n),\ncleaned_data AS (\n    SELECT\n        prd_id,\n        replace(substr(prd_key, 1,5),'-','_') as cat_id,\n        substr(prd_key, 7, length(prd_key)) as prd_code,\n        prd_nm,\n        prd_cost,\n        case\n            when upper(trim(prd_line)) = 'M' then 'Mountains'\n            when upper(trim(prd_line)) = 'R' then 'Road'\n            when upper(trim(prd_line)) = 'S' then 'Sales'\n            when upper(trim(prd_line)) = 'T' then 'Touring'\n            else 'n/a'\n        end as prd_line,\n        CASE\n            WHEN prd_start_dt IS NULL THEN '2006-01-01'  -- Default for missing start\n            WHEN prd_end_dt IS NOT NULL AND prd_end_dt < prd_start_dt THEN prd_end_dt\n            ELSE prd_start_dt\n        END AS prd_start_date,\n        CASE\n            WHEN prd_end_dt IS NULL THEN '9999-12-31'  -- Default for missing end\n            WHEN prd_end_dt < prd_start_dt THEN prd_start_dt\n            ELSE prd_end_dt\n        END AS prd_end_date,\n        ingested_at, -- remove if irrelevant downstream\n        updated_at\n    FROM source_table\n)\nSELECT \n    *\nFROM cleaned_data\n", "relation_name": "\"dwh\".\"silver\".\"crm_prd_info\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.770895Z", "completed_at": "2025-04-05T20:51:04.774322Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.774667Z", "completed_at": "2025-04-05T20:51:04.774672Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00454401969909668, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_prd_info_ingested_at.2893c430a5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"bronze\".\"bz_crm_prd_info\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.776204Z", "completed_at": "2025-04-05T20:51:04.781918Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.782252Z", "completed_at": "2025-04-05T20:51:04.782257Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006783008575439453, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_prd_info_prd_id.de20ac871d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_id\nfrom \"dwh\".\"bronze\".\"bz_crm_prd_info\"\nwhere prd_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.783797Z", "completed_at": "2025-04-05T20:51:04.787382Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.787723Z", "completed_at": "2025-04-05T20:51:04.787727Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004644870758056641, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_prd_info_prd_key.18db73cec9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_key\nfrom \"dwh\".\"bronze\".\"bz_crm_prd_info\"\nwhere prd_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.789251Z", "completed_at": "2025-04-05T20:51:04.792630Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.792949Z", "completed_at": "2025-04-05T20:51:04.792954Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004418134689331055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_prd_info_prd_start_dt.620afd0a00", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_start_dt\nfrom \"dwh\".\"bronze\".\"bz_crm_prd_info\"\nwhere prd_start_dt is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.794504Z", "completed_at": "2025-04-05T20:51:04.798131Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.798471Z", "completed_at": "2025-04-05T20:51:04.798477Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004716157913208008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_prd_info_updated_at.8742d3673b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"bronze\".\"bz_crm_prd_info\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.800071Z", "completed_at": "2025-04-05T20:51:04.804097Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.804534Z", "completed_at": "2025-04-05T20:51:04.804540Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0052301883697509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_bz_crm_prd_info_prd_id.12fd88857e", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    prd_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"bronze\".\"bz_crm_prd_info\"\nwhere prd_id is not null\ngroup by prd_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.806243Z", "completed_at": "2025-04-05T20:51:04.810968Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.811365Z", "completed_at": "2025-04-05T20:51:04.811371Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005908966064453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_sales_details_ingested_at.23dcba1d80", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"bronze\".\"bz_crm_sales_details\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.813011Z", "completed_at": "2025-04-05T20:51:04.816650Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.816991Z", "completed_at": "2025-04-05T20:51:04.816996Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0047588348388671875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_sales_details_sls_cust_id.01831db7c4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_cust_id\nfrom \"dwh\".\"bronze\".\"bz_crm_sales_details\"\nwhere sls_cust_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.818560Z", "completed_at": "2025-04-05T20:51:04.821903Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.822210Z", "completed_at": "2025-04-05T20:51:04.822216Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004404783248901367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_sales_details_sls_ord_num.56c7374457", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_ord_num\nfrom \"dwh\".\"bronze\".\"bz_crm_sales_details\"\nwhere sls_ord_num is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.823683Z", "completed_at": "2025-04-05T20:51:04.827272Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.827577Z", "completed_at": "2025-04-05T20:51:04.827583Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0046007633209228516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_sales_details_sls_prd_key.8a92f0a74f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_prd_key\nfrom \"dwh\".\"bronze\".\"bz_crm_sales_details\"\nwhere sls_prd_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.829195Z", "completed_at": "2025-04-05T20:51:04.833042Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.833441Z", "completed_at": "2025-04-05T20:51:04.833447Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005093097686767578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_sales_details_sls_quantity.d87cd738e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_quantity\nfrom \"dwh\".\"bronze\".\"bz_crm_sales_details\"\nwhere sls_quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.835263Z", "completed_at": "2025-04-05T20:51:04.841537Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.841982Z", "completed_at": "2025-04-05T20:51:04.841988Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00757598876953125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_crm_sales_details_updated_at.d78d14353f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"bronze\".\"bz_crm_sales_details\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.843777Z", "completed_at": "2025-04-05T20:51:04.848509Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.848892Z", "completed_at": "2025-04-05T20:51:04.848897Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005970954895019531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.valid_date_format_bz_crm_sales_details_sls_due_dt.53fba7324b", "compiled": true, "compiled_code": "\nSELECT \n    *\nFROM \"dwh\".\"bronze\".\"bz_crm_sales_details\"\nWHERE \n    sls_due_dt IS NOT NULL\n    AND sls_due_dt::TEXT !~ '^[0-9]{8}$'\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.850590Z", "completed_at": "2025-04-05T20:51:04.854494Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.854870Z", "completed_at": "2025-04-05T20:51:04.854877Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005140066146850586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.valid_date_format_bz_crm_sales_details_sls_order_dt.7f1b4100eb", "compiled": true, "compiled_code": "\nSELECT \n    *\nFROM \"dwh\".\"bronze\".\"bz_crm_sales_details\"\nWHERE \n    sls_order_dt IS NOT NULL\n    AND sls_order_dt::TEXT !~ '^[0-9]{8}$'\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.856783Z", "completed_at": "2025-04-05T20:51:04.860923Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.861339Z", "completed_at": "2025-04-05T20:51:04.861344Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005410194396972656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.valid_date_format_bz_crm_sales_details_sls_ship_dt.7335e91999", "compiled": true, "compiled_code": "\nSELECT \n    *\nFROM \"dwh\".\"bronze\".\"bz_crm_sales_details\"\nWHERE \n    sls_ship_dt IS NOT NULL\n    AND sls_ship_dt::TEXT !~ '^[0-9]{8}$'\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.863218Z", "completed_at": "2025-04-05T20:51:04.866657Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.867006Z", "completed_at": "2025-04-05T20:51:04.867011Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004645109176635742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.erp_cust_az12", "compiled": true, "compiled_code": "\n\nWITH source as (\n    SELECT \n        *\n    FROM \"dwh\".\"bronze\".\"bz_erp_cust_az12\"\n\n),\ncleaned_erp_cust as (\n    SELECT \n        CASE\n            WHEN cid LIKE 'NAS%' THEN Substr(cid, 4, Length(cid))\n            ELSE cid\n            END AS cid,\n            CASE\n            WHEN bdate > CURRENT_DATE THEN NULL\n            ELSE bdate\n            END AS bdate,\n            CASE\n            WHEN Upper(Trim(gen)) IN ( 'M', 'MALE' ) THEN 'Male'\n            WHEN Upper(Trim(gen)) IN ( 'F', 'FEMALE' ) THEN 'Female'\n            ELSE 'n/a'\n            END AS gen,\n            ingested_at,\n            updated_at\n    FROM source\n)\nSELECT \n    *\nFROM cleaned_erp_cust\n", "relation_name": "\"dwh\".\"silver\".\"erp_cust_az12\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.868928Z", "completed_at": "2025-04-05T20:51:04.872875Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.873295Z", "completed_at": "2025-04-05T20:51:04.873301Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005406856536865234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_erp_cust_az12_cid.774c60760d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cid\nfrom \"dwh\".\"bronze\".\"bz_erp_cust_az12\"\nwhere cid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.875086Z", "completed_at": "2025-04-05T20:51:04.879084Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.879433Z", "completed_at": "2025-04-05T20:51:04.879439Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00519108772277832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_erp_cust_az12_ingested_at.c3826ee9f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"bronze\".\"bz_erp_cust_az12\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.881235Z", "completed_at": "2025-04-05T20:51:04.885264Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.885699Z", "completed_at": "2025-04-05T20:51:04.885705Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005343914031982422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_erp_cust_az12_updated_at.aed585f42f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"bronze\".\"bz_erp_cust_az12\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.887706Z", "completed_at": "2025-04-05T20:51:04.891692Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.892097Z", "completed_at": "2025-04-05T20:51:04.892103Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005455732345581055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.erp_loc_a101", "compiled": true, "compiled_code": "\nWITH source AS (\n    SELECT\n        * \n    FROM \"dwh\".\"bronze\".\"bz_erp_loc_a101\"\n),\ncleaned_erp_loc as (\n    SELECT\n        replace (cid, '-', '') AS cid,\n        CASE\n            WHEN TRIM(cntry) = 'DE' THEN 'Germany'\n            WHEN TRIM(cntry) IN ('US', 'USA') THEN 'United States'\n            WHEN TRIM(cntry) = ''\n            OR TRIM(cntry) IS NULL THEN 'n/a'\n            ELSE TRIM(cntry)\n        END AS cntry,\n        ingested_at,\n        updated_at\n    FROM source\n)\nSELECT \n    *\nFROM cleaned_erp_loc\n\n", "relation_name": "\"dwh\".\"silver\".\"erp_loc_a101\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.894134Z", "completed_at": "2025-04-05T20:51:04.898551Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.899054Z", "completed_at": "2025-04-05T20:51:04.899061Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005802154541015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_erp_loc_a101_cid.91e1f30b67", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cid\nfrom \"dwh\".\"bronze\".\"bz_erp_loc_a101\"\nwhere cid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.900905Z", "completed_at": "2025-04-05T20:51:04.907674Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.908109Z", "completed_at": "2025-04-05T20:51:04.908118Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008162975311279297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_erp_loc_a101_ingested_at.749d640110", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"bronze\".\"bz_erp_loc_a101\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.909916Z", "completed_at": "2025-04-05T20:51:04.914499Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.914891Z", "completed_at": "2025-04-05T20:51:04.914897Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0058519840240478516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_erp_loc_a101_updated_at.674384578b", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"bronze\".\"bz_erp_loc_a101\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.916882Z", "completed_at": "2025-04-05T20:51:04.921814Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.922363Z", "completed_at": "2025-04-05T20:51:04.922369Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006509065628051758, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.erp_px_cat_g1v2", "compiled": true, "compiled_code": "\nWITH source AS (\n    SELECT\n        * \n    FROM \"dwh\".\"bronze\".\"bz_erp_px_cat_g1v2\"\n),\ncleaned_prd_cat AS (\n    SELECT\n        TRIM(id) AS id,\n        TRIM(cat) AS cat,\n        TRIM(subcat) AS subcat,\n        TRIM(maintenance) AS maintenance_status,\n        ingested_at,\n        updated_at\n    FROM source\n)\nSELECT \n    *\nFROM cleaned_prd_cat\n", "relation_name": "\"dwh\".\"silver\".\"erp_px_cat_g1v2\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.925507Z", "completed_at": "2025-04-05T20:51:04.930647Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.931273Z", "completed_at": "2025-04-05T20:51:04.931295Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007325887680053711, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_erp_px_cat_g1v2_id.965f4cf4ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dwh\".\"bronze\".\"bz_erp_px_cat_g1v2\"\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.934435Z", "completed_at": "2025-04-05T20:51:04.940749Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.941574Z", "completed_at": "2025-04-05T20:51:04.941582Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008671998977661133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_erp_px_cat_g1v2_ingested_at.b4f577cb11", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"bronze\".\"bz_erp_px_cat_g1v2\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.945254Z", "completed_at": "2025-04-05T20:51:04.953474Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.954025Z", "completed_at": "2025-04-05T20:51:04.954033Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01041102409362793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_bz_erp_px_cat_g1v2_updated_at.210fe71e5d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"bronze\".\"bz_erp_px_cat_g1v2\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.956437Z", "completed_at": "2025-04-05T20:51:04.967912Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.968365Z", "completed_at": "2025-04-05T20:51:04.968372Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013209104537963867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_crm_cust_info_cst_gndr__Male__Female__n_a.ddceddf11e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        cst_gndr as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"silver\".\"crm_cust_info\"\n    group by cst_gndr\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Male','Female','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.972485Z", "completed_at": "2025-04-05T20:51:04.985480Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.986048Z", "completed_at": "2025-04-05T20:51:04.986055Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01577281951904297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_crm_cust_info_cst_marital_status__Married__Single__n_a.d012437934", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        cst_marital_status as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"silver\".\"crm_cust_info\"\n    group by cst_marital_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Married','Single','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.988476Z", "completed_at": "2025-04-05T20:51:04.993883Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:04.994354Z", "completed_at": "2025-04-05T20:51:04.994362Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0072116851806640625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_crm_cust_info_cst_code.ab58decf40", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere cst_code != trim(cst_code)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.998451Z", "completed_at": "2025-04-05T20:51:05.006078Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.006636Z", "completed_at": "2025-04-05T20:51:05.006644Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009608030319213867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_crm_cust_info_cst_firstname.96efd6996d", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere cst_firstname != trim(cst_firstname)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.009296Z", "completed_at": "2025-04-05T20:51:05.014988Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.015460Z", "completed_at": "2025-04-05T20:51:05.015479Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0076749324798583984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_crm_cust_info_cst_lastname.2a16cae8de", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere cst_lastname != trim(cst_lastname)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.017771Z", "completed_at": "2025-04-05T20:51:05.022509Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.023183Z", "completed_at": "2025-04-05T20:51:05.023191Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006540060043334961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_crm_cust_info_cst_place.2e379fe18c", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere cst_place != trim(cst_place)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.025817Z", "completed_at": "2025-04-05T20:51:05.031440Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.031930Z", "completed_at": "2025-04-05T20:51:05.031938Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007196187973022461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.email_check_crm_cust_info_cst_email.e0248dc48c", "compiled": true, "compiled_code": "\nSELECT \n    *\nFROM \"dwh\".\"silver\".\"crm_cust_info\"\nWHERE \n    cst_email IS NOT NULL\n    AND cst_email != 'unknown'\n    AND cst_email !~ '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$'\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.034165Z", "completed_at": "2025-04-05T20:51:05.039405Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.040120Z", "completed_at": "2025-04-05T20:51:05.040129Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006979703903198242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_cust_info_cst_code.58506a711c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cst_code\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere cst_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.042781Z", "completed_at": "2025-04-05T20:51:05.049148Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.049793Z", "completed_at": "2025-04-05T20:51:05.049803Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008255958557128906, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_cust_info_cst_create_date.9a462c5eb4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cst_create_date\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere cst_create_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.052343Z", "completed_at": "2025-04-05T20:51:05.057598Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.058148Z", "completed_at": "2025-04-05T20:51:05.058157Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007003068923950195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_cust_info_cst_id.91241b201c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cst_id\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere cst_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.060588Z", "completed_at": "2025-04-05T20:51:05.066144Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.066661Z", "completed_at": "2025-04-05T20:51:05.066668Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007185220718383789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_cust_info_ingested_at.4df149d26c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.069319Z", "completed_at": "2025-04-05T20:51:05.074738Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.075341Z", "completed_at": "2025-04-05T20:51:05.075349Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007322072982788086, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_cust_info_updated_at.3308fe3c4e", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.078501Z", "completed_at": "2025-04-05T20:51:05.085756Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.086349Z", "completed_at": "2025-04-05T20:51:05.086358Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009480953216552734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_crm_cust_info_cst_email.139300d73f", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cst_email as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere cst_email is not null\ngroup by cst_email\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.089403Z", "completed_at": "2025-04-05T20:51:05.099419Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.100051Z", "completed_at": "2025-04-05T20:51:05.100060Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012248754501342773, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_crm_cust_info_cst_id.7c73f5004c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    cst_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"silver\".\"crm_cust_info\"\nwhere cst_id is not null\ngroup by cst_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.104255Z", "completed_at": "2025-04-05T20:51:05.112325Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.113031Z", "completed_at": "2025-04-05T20:51:05.113042Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01055002212524414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.crm_sales_details", "compiled": true, "compiled_code": "\n-- Configures the model to enforce a unique key on sls_ord_num, though this is more informational since deduplication happens within the query via ROW_NUMBER(). This signals intent to DBT for potential optimizations or downstream checks.\n\nWITH deduped AS (\n    -- Purpose: Removes duplicate sales records from the bronze layer, keeping only the most recent entry\n    -- for each unique combination of order number (sls_ord_num) and product key (sls_prd_key).\n    SELECT *\n    FROM (\n        SELECT \n            *,\n            -- ROW_NUMBER assigns a unique number to each row within a partition of sls_ord_num and sls_prd_key,\n            -- ordered by updated_at DESC to prioritize the latest record. This ensures we handle cases where\n            -- the same order-product pair appears multiple times due to updates or ingestion errors.\n            ROW_NUMBER() OVER (PARTITION BY sls_ord_num, sls_prd_key ORDER BY updated_at DESC) AS rn\n        FROM \"dwh\".\"bronze\".\"bz_crm_sales_details\"  \n        -- References the bronze table with raw sales data, \n        -- already converted to DATE types from INT.\n    ) t\n    WHERE rn = 1  \n    -- Filters to keep only the first row (latest record) per partition, effectively deduplicating.\n),\n\nproduct_lifecycle AS (\n    -- Purpose: Joins sales data with product lifecycle info to determine the active lifecycle period \n    -- for each sale, handling cases where a product (sls_prd_key) has multiple start/end dates in crm_prd_info.\n    SELECT \n        d.sls_ord_num,\n        d.sls_prd_key,\n        d.sls_cust_id,\n        d.sls_order_dt,  -- Comes from bronze as DATE or NULL (e.g., 0 \u2192 NULL).\n        d.sls_ship_dt,   -- Comes from bronze as DATE, validated as non-NULL in WHERE clause.\n        d.sls_due_dt,\n        d.sls_quantity,\n        d.sls_price,\n        d.sls_sales,\n        d.ingested_at,\n        d.updated_at,\n        p.prd_start_date,  -- Product lifecycle start date from crm_prd_info.\n        p.prd_end_date,    -- Product lifecycle end date from crm_prd_info.\n        -- ROW_NUMBER ranks lifecycle rows for each sls_ord_num, sls_prd_key pair. \n        -- The CASE prioritizes lifecycles where sls_ship_dt falls within prd_start_date and prd_end_date (rn = 1),\n        -- falling back to the latest end date (DESC) if no match (rn > 1). This ensures we pick the active \n        -- lifecycle for the shipment date, addressing multiple lifecycle entries per product.\n        ROW_NUMBER() OVER (PARTITION BY d.sls_ord_num, d.sls_prd_key \n                          ORDER BY CASE \n                                      WHEN d.sls_ship_dt >= p.prd_start_date \n                                           AND d.sls_ship_dt < p.prd_end_date \n                                      THEN 1 \n                                      ELSE 2 \n                                  END, p.prd_end_date DESC) AS rn\n    FROM deduped d\n    LEFT JOIN \"dwh\".\"silver\".\"crm_prd_info\" p  \n    -- LEFT JOIN ensures all sales records are kept, even if no \n    -- product info exists, though all sls_prd_key values should match.\n        ON d.sls_prd_key = p.prd_code\n    WHERE d.sls_ship_dt IS NOT NULL  \n    -- Ensures we only process rows with a valid shipment date, as this is \n    -- critical for lifecycle checks and fallback for sls_order_dt.\n),\n\ncleaned_sales_dates AS (\n    -- Purpose: Cleans and finalizes date fields, ensuring sls_order_dt is populated correctly using \n    -- sls_ship_dt when needed, based on the active product lifecycle.\n    SELECT \n        sls_ord_num,\n        sls_prd_key,\n        sls_cust_id,\n        -- CASE logic for sls_order_dt:\n        -- 1. If sls_order_dt is not NULL (valid from bronze), use it as-is.\n        -- 2. If sls_order_dt is NULL and sls_ship_dt falls within the active lifecycle (ensured by rn = 1),\n        --    use sls_ship_dt as a fallback. This addresses cases where the original order date was invalid (e.g., 0).\n        -- 3. Else, set to NULL (rare due to WHERE rn = 1 and lifecycle check).\n        CASE \n            WHEN sls_order_dt IS NOT NULL THEN sls_order_dt\n            WHEN sls_ship_dt >= prd_start_date \n                 AND sls_ship_dt < prd_end_date \n            THEN sls_ship_dt\n            ELSE NULL\n        END AS sls_order_dt,\n        sls_ship_dt,\n        sls_due_dt,\n        sls_quantity,\n        sls_price,\n        sls_sales,\n        ingested_at,\n        updated_at\n    FROM product_lifecycle\n    WHERE rn = 1  \n    -- Filters to only the top-ranked lifecycle row per sls_ord_num, sls_prd_key, ensuring we use the active lifecycle where sls_ship_dt fits, avoiding ambiguity from multiple matches.\n),\n\ncalculated_sales AS (\n    -- Purpose: Adjusts sales price and total sales values based on data quality rules, ensuring consistency \n    -- and accuracy in financial metrics.\n    SELECT \n        *,\n        -- Adjusts sls_price:\n        -- If sls_price is NULL or negative, calculate it as sls_sales / sls_quantity (avoiding division by 0 \n        -- with NULLIF). Otherwise, keep the original price. This corrects invalid or missing price data.\n        CASE \n            WHEN sls_price IS NULL OR sls_price < 0 \n            THEN sls_sales / NULLIF(sls_quantity, 0)\n            ELSE sls_price \n        END AS adjusted_sls_price,\n        -- Adjusts sls_sales:\n        -- If sls_sales is NULL, negative, or inconsistent with quantity * price, recalculate as \n        -- sls_quantity * ABS(sls_price) to ensure positive, logical totals. Otherwise, keep the original.\n        CASE \n            WHEN sls_sales IS NULL OR sls_sales < 0 OR sls_sales != sls_quantity * ABS(sls_price) \n            THEN sls_quantity * ABS(sls_price)\n            ELSE sls_sales \n        END AS adjusted_sls_sales\n    FROM cleaned_sales_dates\n)\n\nSELECT \n    -- Final output selects all cleaned and adjusted fields, renaming adjusted_sls_price and \n    -- adjusted_sls_sales to sls_price and sls_sales for downstream consistency.\n    sls_ord_num,\n    sls_prd_key,\n    sls_cust_id,\n    sls_order_dt,\n    sls_ship_dt,\n    sls_due_dt,\n    sls_quantity,\n    adjusted_sls_price AS sls_price,\n    adjusted_sls_sales AS sls_sales,\n    ingested_at,\n    updated_at\nFROM calculated_sales\n", "relation_name": "\"dwh\".\"silver\".\"crm_sales_details\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.116626Z", "completed_at": "2025-04-05T20:51:05.128365Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.129206Z", "completed_at": "2025-04-05T20:51:05.129220Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.014202117919921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_crm_prd_info_prd_line__Mountains__Road__Sales__Touring__n_a.2e1af5bd62", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        prd_line as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"silver\".\"crm_prd_info\"\n    group by prd_line\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Mountains','Road','Sales','Touring','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.133249Z", "completed_at": "2025-04-05T20:51:05.141435Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.142487Z", "completed_at": "2025-04-05T20:51:05.142499Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011059999465942383, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_crm_prd_info_prd_code.05162b5d85", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere prd_code != trim(prd_code)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.146964Z", "completed_at": "2025-04-05T20:51:05.155104Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.155910Z", "completed_at": "2025-04-05T20:51:05.155921Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011400938034057617, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_crm_prd_info_prd_nm.d1865c7e7d", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere prd_nm != trim(prd_nm)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.159792Z", "completed_at": "2025-04-05T20:51:05.176388Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.177245Z", "completed_at": "2025-04-05T20:51:05.177260Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.019273996353149414, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_crm_prd_info_prd_cost___0.605c9255ee", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\n\nwhere not(prd_cost >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.181819Z", "completed_at": "2025-04-05T20:51:05.191910Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.192858Z", "completed_at": "2025-04-05T20:51:05.192870Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013257026672363281, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_crm_prd_info_prd_end_date___prd_start_date.6cc3176193", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\n\nwhere not(prd_end_date >= prd_start_date)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.197465Z", "completed_at": "2025-04-05T20:51:05.206080Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.206895Z", "completed_at": "2025-04-05T20:51:05.206906Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011752128601074219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_prd_info_cat_id.5024f04cdb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cat_id\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere cat_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.210678Z", "completed_at": "2025-04-05T20:51:05.218966Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.219827Z", "completed_at": "2025-04-05T20:51:05.219839Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011041879653930664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_prd_info_ingested_at.6858ecc3e5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.222882Z", "completed_at": "2025-04-05T20:51:05.229433Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.229992Z", "completed_at": "2025-04-05T20:51:05.230001Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008476018905639648, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_prd_info_prd_code.a15839d0cd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_code\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere prd_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.232562Z", "completed_at": "2025-04-05T20:51:05.242367Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.242962Z", "completed_at": "2025-04-05T20:51:05.242971Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011620044708251953, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_prd_info_prd_cost.279fd05d93", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_cost\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere prd_cost is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.245767Z", "completed_at": "2025-04-05T20:51:05.255034Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.255869Z", "completed_at": "2025-04-05T20:51:05.255877Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011471986770629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_prd_info_prd_end_date.4bac02b05d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_end_date\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere prd_end_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.258359Z", "completed_at": "2025-04-05T20:51:05.263709Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.264168Z", "completed_at": "2025-04-05T20:51:05.264175Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00689387321472168, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_prd_info_prd_id.2f30e67051", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_id\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere prd_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.266301Z", "completed_at": "2025-04-05T20:51:05.271371Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.271833Z", "completed_at": "2025-04-05T20:51:05.271841Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0065190792083740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_prd_info_prd_nm.119673e4d4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_nm\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere prd_nm is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.274048Z", "completed_at": "2025-04-05T20:51:05.279627Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.280118Z", "completed_at": "2025-04-05T20:51:05.280125Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007172107696533203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_prd_info_prd_start_date.83b2f0095a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_start_date\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere prd_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.282480Z", "completed_at": "2025-04-05T20:51:05.287964Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.288470Z", "completed_at": "2025-04-05T20:51:05.288477Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0071790218353271484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_prd_info_updated_at.fc3e5e584c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.290744Z", "completed_at": "2025-04-05T20:51:05.295489Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.295912Z", "completed_at": "2025-04-05T20:51:05.295918Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006227016448974609, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_crm_prd_info_prd_id.f3cfe19adf", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    prd_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"silver\".\"crm_prd_info\"\nwhere prd_id is not null\ngroup by prd_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.297956Z", "completed_at": "2025-04-05T20:51:05.302900Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.303392Z", "completed_at": "2025-04-05T20:51:05.303400Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0063741207122802734, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_erp_cust_az12_gen__Male__Female__n_a.a4899b28d0", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        gen as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"silver\".\"erp_cust_az12\"\n    group by gen\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Male','Female','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.305770Z", "completed_at": "2025-04-05T20:51:05.310763Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.311220Z", "completed_at": "2025-04-05T20:51:05.311227Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00669407844543457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_erp_cust_az12_cid.0e1740cd50", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"erp_cust_az12\"\nwhere cid != trim(cid)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.313501Z", "completed_at": "2025-04-05T20:51:05.320875Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.321312Z", "completed_at": "2025-04-05T20:51:05.321318Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008896112442016602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_erp_cust_az12_cid.85e0f9c5c3", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cid\nfrom \"dwh\".\"silver\".\"erp_cust_az12\"\nwhere cid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.323540Z", "completed_at": "2025-04-05T20:51:05.327915Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.328357Z", "completed_at": "2025-04-05T20:51:05.328365Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0058879852294921875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_erp_cust_az12_ingested_at.a86586ca8a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"silver\".\"erp_cust_az12\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.330464Z", "completed_at": "2025-04-05T20:51:05.334695Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.335224Z", "completed_at": "2025-04-05T20:51:05.335231Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00570988655090332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_erp_cust_az12_updated_at.9fd920946d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"silver\".\"erp_cust_az12\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.337401Z", "completed_at": "2025-04-05T20:51:05.340547Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.341025Z", "completed_at": "2025-04-05T20:51:05.341031Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004610776901245117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_transform.customers_snapshot", "compiled": true, "compiled_code": "\n\nSELECT\n    ci.cst_id,\n    ci.cst_code,\n    ci.cst_firstname,\n    ci.cst_lastname,\n    ea.bdate AS erp_birthdate,\n    ci.cst_marital_status,\n    ci.cst_gndr,\n    ci.cst_email,\n    ci.cst_place,\n    el.cntry AS erp_country,\n    ci.cst_postal_code,\n    ea.gen AS erp_gender,\n    ci.cst_create_date,\n    GREATEST(ci.updated_at, ea.updated_at, el.updated_at) AS snapshot_updated_at\nFROM \"dwh\".\"silver\".\"crm_cust_info\" ci\nLEFT JOIN \"dwh\".\"silver\".\"erp_cust_az12\" ea\n    ON ci.cst_code = ea.cid\nLEFT JOIN \"dwh\".\"silver\".\"erp_loc_a101\" el\n    ON ci.cst_code = el.cid\n", "relation_name": "\"dwh\".\"snapshots\".\"customers_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.343457Z", "completed_at": "2025-04-05T20:51:05.351471Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.351928Z", "completed_at": "2025-04-05T20:51:05.351935Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009741067886352539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_erp_loc_a101_cntry__Australia__Canada__France__Germany__United_Kingdom__United_States__n_a.8b1d17bcc2", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        cntry as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"silver\".\"erp_loc_a101\"\n    group by cntry\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Australia','Canada','France','Germany','United Kingdom','United States','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.353982Z", "completed_at": "2025-04-05T20:51:05.358064Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.358514Z", "completed_at": "2025-04-05T20:51:05.358520Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005558013916015625, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_erp_loc_a101_cid.b5c96a26e9", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"erp_loc_a101\"\nwhere cid != trim(cid)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.360456Z", "completed_at": "2025-04-05T20:51:05.364777Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.365177Z", "completed_at": "2025-04-05T20:51:05.365183Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005688190460205078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_erp_loc_a101_cntry.e764b06576", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"erp_loc_a101\"\nwhere cntry != trim(cntry)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.367006Z", "completed_at": "2025-04-05T20:51:05.371187Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.371629Z", "completed_at": "2025-04-05T20:51:05.371634Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005472898483276367, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_erp_loc_a101_cid.babef803af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect cid\nfrom \"dwh\".\"silver\".\"erp_loc_a101\"\nwhere cid is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.373824Z", "completed_at": "2025-04-05T20:51:05.379923Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.380319Z", "completed_at": "2025-04-05T20:51:05.380324Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007903814315795898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_erp_loc_a101_ingested_at.5fa40abeeb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"silver\".\"erp_loc_a101\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.382399Z", "completed_at": "2025-04-05T20:51:05.386930Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.387344Z", "completed_at": "2025-04-05T20:51:05.387350Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005820035934448242, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_erp_loc_a101_updated_at.66ab7ce54c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"silver\".\"erp_loc_a101\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.389196Z", "completed_at": "2025-04-05T20:51:05.394337Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.394824Z", "completed_at": "2025-04-05T20:51:05.394830Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0065038204193115234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "snapshot.dbt_transform.products_snapshot", "compiled": true, "compiled_code": "\nSELECT \n    pi.prd_id,\n    pi.prd_code,\n    pi.cat_id,\n    pc.cat AS erp_cat,\n    pc.subcat AS erp_subcat,\n    pi.prd_nm,\n    pi.prd_line,\n    pi.prd_cost,\n    pc.maintenance_status AS erp_maintenance_status,\n    pi.prd_start_date,\n    pi.prd_end_date,\n    GREATEST(pi.updated_at, pc.updated_at) AS snapshot_updated_at\nFROM \"dwh\".\"silver\".\"crm_prd_info\" AS pi\nLEFT JOIN \"dwh\".\"silver\".\"erp_px_cat_g1v2\" AS pc\n    ON pi.cat_id = pc.id", "relation_name": "\"dwh\".\"snapshots\".\"products_snapshot\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.396831Z", "completed_at": "2025-04-05T20:51:05.403117Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.403607Z", "completed_at": "2025-04-05T20:51:05.403615Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007831096649169922, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_erp_px_cat_g1v2_maintenance_status__Yes__No.579d39cf7d", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        maintenance_status as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"silver\".\"erp_px_cat_g1v2\"\n    group by maintenance_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Yes','No'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.405588Z", "completed_at": "2025-04-05T20:51:05.409509Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.409885Z", "completed_at": "2025-04-05T20:51:05.409892Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005303144454956055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_erp_px_cat_g1v2_cat.5b96c7bce1", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"erp_px_cat_g1v2\"\nwhere cat != trim(cat)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.413820Z", "completed_at": "2025-04-05T20:51:05.417726Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.418101Z", "completed_at": "2025-04-05T20:51:05.418107Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006851911544799805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_erp_px_cat_g1v2_id.92860219f5", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"erp_px_cat_g1v2\"\nwhere id != trim(id)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.419713Z", "completed_at": "2025-04-05T20:51:05.423601Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.423941Z", "completed_at": "2025-04-05T20:51:05.423946Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.004992008209228516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_erp_px_cat_g1v2_maintenance_status.c2f302cba9", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"erp_px_cat_g1v2\"\nwhere maintenance_status != trim(maintenance_status)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.425703Z", "completed_at": "2025-04-05T20:51:05.429600Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.429959Z", "completed_at": "2025-04-05T20:51:05.429966Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00510096549987793, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_erp_px_cat_g1v2_subcat.164f225283", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"erp_px_cat_g1v2\"\nwhere subcat != trim(subcat)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.432023Z", "completed_at": "2025-04-05T20:51:05.450663Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.451439Z", "completed_at": "2025-04-05T20:51:05.451447Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.020618915557861328, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_erp_px_cat_g1v2_id.b5825d0c02", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect id\nfrom \"dwh\".\"silver\".\"erp_px_cat_g1v2\"\nwhere id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.453907Z", "completed_at": "2025-04-05T20:51:05.460611Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.461072Z", "completed_at": "2025-04-05T20:51:05.461079Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008380889892578125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_erp_px_cat_g1v2_ingested_at.b8fc6358c1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"silver\".\"erp_px_cat_g1v2\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.464447Z", "completed_at": "2025-04-05T20:51:05.472211Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.473180Z", "completed_at": "2025-04-05T20:51:05.473198Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010309696197509766, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_erp_px_cat_g1v2_updated_at.64f8508b6f", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"silver\".\"erp_px_cat_g1v2\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.475692Z", "completed_at": "2025-04-05T20:51:05.480565Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.480950Z", "completed_at": "2025-04-05T20:51:05.480957Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006350994110107422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_crm_sales_details_sls_ord_num.167f0728aa", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere sls_ord_num != trim(sls_ord_num)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.482968Z", "completed_at": "2025-04-05T20:51:05.491929Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.492417Z", "completed_at": "2025-04-05T20:51:05.492425Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010439872741699219, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_crm_sales_details_sls_prd_key.a501150291", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere sls_prd_key != trim(sls_prd_key)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.494713Z", "completed_at": "2025-04-05T20:51:05.500111Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.500584Z", "completed_at": "2025-04-05T20:51:05.500590Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0068721771240234375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_crm_sales_details_ABS_sls_sales_sls_quantity_sls_price_0_01.d2788e1779", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\n\nwhere not(ABS(sls_sales - (sls_quantity * sls_price)) < 0.01)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.502604Z", "completed_at": "2025-04-05T20:51:05.508650Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.509181Z", "completed_at": "2025-04-05T20:51:05.509190Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007693767547607422, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_crm_sales_details_sls_order_dt_sls_ship_dt_AND_sls_order_dt_sls_due_dt.76971c3329", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom (select * from \"dwh\".\"silver\".\"crm_sales_details\" where sls_order_dt IS NOT NULL AND sls_ship_dt IS NOT NULL AND sls_due_dt IS NOT NULL) dbt_subquery\n\nwhere not(sls_order_dt <= sls_ship_dt AND sls_order_dt <= sls_due_dt)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.512060Z", "completed_at": "2025-04-05T20:51:05.518664Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.519198Z", "completed_at": "2025-04-05T20:51:05.519205Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008374929428100586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_crm_sales_details_sls_price___0.88b98ec27b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\n\nwhere not(sls_price >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.522255Z", "completed_at": "2025-04-05T20:51:05.528400Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.528905Z", "completed_at": "2025-04-05T20:51:05.528912Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008420944213867188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_crm_sales_details_sls_quantity___0.80310b3b9b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\n\nwhere not(sls_quantity >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.532061Z", "completed_at": "2025-04-05T20:51:05.538642Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.539332Z", "completed_at": "2025-04-05T20:51:05.539339Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008849143981933594, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_crm_sales_details_sls_sales___0.32b636e941", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\n\nwhere not(sls_sales >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.542269Z", "completed_at": "2025-04-05T20:51:05.554288Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.556055Z", "completed_at": "2025-04-05T20:51:05.556073Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.015990018844604492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_sales_details_ingested_at.665ecb63bb", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect ingested_at\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere ingested_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.579517Z", "completed_at": "2025-04-05T20:51:05.587988Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.588804Z", "completed_at": "2025-04-05T20:51:05.588812Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.027776002883911133, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_sales_details_sls_cust_id.0a46ca14bf", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_cust_id\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere sls_cust_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.591951Z", "completed_at": "2025-04-05T20:51:05.597671Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.598236Z", "completed_at": "2025-04-05T20:51:05.598245Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00808095932006836, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_sales_details_sls_ord_num.284ab08e44", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_ord_num\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere sls_ord_num is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.600851Z", "completed_at": "2025-04-05T20:51:05.607040Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.607655Z", "completed_at": "2025-04-05T20:51:05.607664Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007977008819580078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_sales_details_sls_prd_key.1a14bfff89", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_prd_key\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere sls_prd_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.610170Z", "completed_at": "2025-04-05T20:51:05.618457Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.619086Z", "completed_at": "2025-04-05T20:51:05.619095Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01017904281616211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_sales_details_sls_price.ab8d58b73d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_price\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere sls_price is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.622504Z", "completed_at": "2025-04-05T20:51:05.628364Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.628920Z", "completed_at": "2025-04-05T20:51:05.628930Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007905960083007812, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_sales_details_sls_quantity.4c23255cdd", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_quantity\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere sls_quantity is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.631306Z", "completed_at": "2025-04-05T20:51:05.636406Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.636858Z", "completed_at": "2025-04-05T20:51:05.636865Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00661015510559082, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_sales_details_sls_sales.9250f7ded0", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sls_sales\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere sls_sales is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.639087Z", "completed_at": "2025-04-05T20:51:05.646733Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.648421Z", "completed_at": "2025-04-05T20:51:05.648431Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010321855545043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_crm_sales_details_updated_at.329e7c70af", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect updated_at\nfrom \"dwh\".\"silver\".\"crm_sales_details\"\nwhere updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.653499Z", "completed_at": "2025-04-05T20:51:05.658077Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.658544Z", "completed_at": "2025-04-05T20:51:05.658551Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0063931941986083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.dim_customers_current", "compiled": true, "compiled_code": "WITH current_customer_data AS (\n    SELECT\n        cst_id AS customer_id,\n        cst_code AS customer_code,\n        cst_firstname AS customer_firstname,\n        cst_lastname AS customer_lastname,\n        erp_birthdate AS customer_birthdate,\n        CASE\n            WHEN cst_gndr != 'n/a' THEN cst_gndr\n            ELSE COALESCE(erp_gender, 'n/a')\n        END AS customer_gender,\n        cst_marital_status AS customer_marital_status,\n        erp_country AS customer_country,\n        cst_email AS customer_email,\n        cst_place AS customer_place,\n        cst_postal_code AS customer_postal_code,\n        cst_create_date AS customer_create_date\n    FROM \"dwh\".\"snapshots\".\"customers_snapshot\"\n    WHERE dbt_valid_to = '9999-12-31'  \n)\nSELECT\n    ROW_NUMBER() OVER (ORDER BY customer_id) AS customer_key,\n    *\nFROM current_customer_data", "relation_name": "\"dwh\".\"gold\".\"dim_customers_current\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.661439Z", "completed_at": "2025-04-05T20:51:05.665707Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.666174Z", "completed_at": "2025-04-05T20:51:05.666181Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005957841873168945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.dim_customers_hist", "compiled": true, "compiled_code": "WITH customers_snapshot_h AS (\n    SELECT \n        cst_id,\n        cst_code,\n        cst_firstname,\n        cst_lastname,\n        erp_birthdate,\n        cst_marital_status,\n        cst_gndr,\n        cst_email,\n        cst_place,\n        erp_country,\n        cst_postal_code,\n        erp_gender,\n        cst_create_date,\n        dbt_valid_from,\n        dbt_valid_to\n    FROM \"dwh\".\"snapshots\".\"customers_snapshot\"\n),\naggregated_customer_data AS (\n    SELECT\n        cst_id AS customer_id,\n        cst_code AS customer_code,\n        cst_firstname AS customer_firstname,\n        cst_lastname AS customer_lastname,\n        erp_birthdate AS customer_birthdate,\n        CASE\n            WHEN cst_gndr != 'n/a' THEN cst_gndr\n            ELSE COALESCE(erp_gender, 'n/a')\n        END AS customer_gender,\n        cst_marital_status AS customer_marital_status,\n        erp_country AS customer_country,\n        cst_email AS customer_email,\n        cst_place AS customer_place,\n        cst_postal_code AS customer_postal_code,\n        cst_create_date AS customer_create_date,\n        dbt_valid_from AS valid_from,\n        dbt_valid_to AS valid_to\n    FROM customers_snapshot_h\n)\nSELECT\n    ROW_NUMBER() OVER (ORDER BY customer_id, valid_from) AS customer_key,\n    *\nFROM aggregated_customer_data", "relation_name": "\"dwh\".\"gold\".\"dim_customers_hist\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.668688Z", "completed_at": "2025-04-05T20:51:05.673850Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.674327Z", "completed_at": "2025-04-05T20:51:05.674335Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006680011749267578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_customers_snapshot_dbt_scd_id.d7c60e61aa", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_scd_id\nfrom \"dwh\".\"snapshots\".\"customers_snapshot\"\nwhere dbt_scd_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.676725Z", "completed_at": "2025-04-05T20:51:05.682414Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.682911Z", "completed_at": "2025-04-05T20:51:05.682919Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007414102554321289, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_customers_snapshot_dbt_updated_at.1b87573d98", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_updated_at\nfrom \"dwh\".\"snapshots\".\"customers_snapshot\"\nwhere dbt_updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.685509Z", "completed_at": "2025-04-05T20:51:05.691049Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.691550Z", "completed_at": "2025-04-05T20:51:05.691558Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007373809814453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_customers_snapshot_dbt_valid_from.9ebd11d9e2", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_valid_from\nfrom \"dwh\".\"snapshots\".\"customers_snapshot\"\nwhere dbt_valid_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:04.659354Z", "completed_at": "2025-04-05T20:51:05.704153Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.704812Z", "completed_at": "2025-04-05T20:51:05.704819Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.0479240417480469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.copy_gold_tables_to_duckdb", "compiled": true, "compiled_code": "/*\n  Model: copy_gold_tables\n\n  Description:\n    Syncs gold-layer tables from PostgreSQL to DuckDB by invoking the `copy_all_from_postgres_gold` macro.\n    Copies `fact_sales`, `dim_customers`, and `dim_products` from the Postgres `gold` schema to the DuckDB `gold` schema.\n    Materializes a dummy table (`gold.copy_gold_tables`) with a single row to satisfy dbt.\n\n  Dependencies:\n    - Macro: `copy_all_from_postgres_gold` (defined in macros/copy_all_from_postgres_gold.sql).\n    - Environment variables: POSTGRES_USER, POSTGRES_PASSWORD, POSTGRES_HOST, POSTGRES_PORT, POSTGRES_DB.\n    - DuckDB `postgres_scanner` extension (auto-installed).\n\n  Usage:\n    Run via dbt: `dbt run --select copy_gold_tables --profile dbt_duckdb`\n\n  Output:\n    - Creates/replaces DuckDB tables: `gold.fact_sales`, `gold.dim_customers`, `gold.dim_products`.\n    - Materializes `gold.copy_gold_tables` with one row (`status = 1`).\n*/\n -- for dbt docs generate errors\n  \n    -- Return a dummy result to satisfy dbt\n    SELECT 1 AS status\n\n", "relation_name": "\"dwh\".\"main\".\"copy_gold_tables_to_duckdb\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.696769Z", "completed_at": "2025-04-05T20:51:05.705420Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.706599Z", "completed_at": "2025-04-05T20:51:05.706604Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011643171310424805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_customers_snapshot_dbt_valid_to.e956fef5d5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_valid_to\nfrom \"dwh\".\"snapshots\".\"customers_snapshot\"\nwhere dbt_valid_to is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.710246Z", "completed_at": "2025-04-05T20:51:05.725113Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.725538Z", "completed_at": "2025-04-05T20:51:05.725544Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.017317771911621094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.relationships_customers_snapshot_cst_code__cid__ref_erp_cust_az12_.5bf61612cf", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select cst_code as from_field\n    from \"dwh\".\"snapshots\".\"customers_snapshot\"\n    where cst_code is not null\n),\n\nparent as (\n    select cid as to_field\n    from \"dwh\".\"silver\".\"erp_cust_az12\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.719798Z", "completed_at": "2025-04-05T20:51:05.726696Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.727547Z", "completed_at": "2025-04-05T20:51:05.727552Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.018764019012451172, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.relationships_customers_snapshot_cst_code__cid__ref_erp_loc_a101_.7922ee1486", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select cst_code as from_field\n    from \"dwh\".\"snapshots\".\"customers_snapshot\"\n    where cst_code is not null\n),\n\nparent as (\n    select cid as to_field\n    from \"dwh\".\"silver\".\"erp_loc_a101\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.729103Z", "completed_at": "2025-04-05T20:51:05.737051Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.737485Z", "completed_at": "2025-04-05T20:51:05.737492Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010492086410522461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_customers_snapshot_dbt_scd_id.bae3323096", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    dbt_scd_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"snapshots\".\"customers_snapshot\"\nwhere dbt_scd_id is not null\ngroup by dbt_scd_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.734023Z", "completed_at": "2025-04-05T20:51:05.738733Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.739559Z", "completed_at": "2025-04-05T20:51:05.739565Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00657200813293457, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.dim_products_current", "compiled": true, "compiled_code": "WITH aggregated_product_data AS (\n    SELECT\n        prd_id AS product_id,\n        prd_code AS product_code,\n        prd_nm AS product_name,\n        cat_id AS product_cat_id,\n        erp_cat AS product_category,\n        erp_subcat AS product_subcategory,\n        erp_maintenance_status AS product_maintenance_status,\n        prd_cost AS product_cost,\n        prd_line AS product_line,\n        prd_start_date AS product_start_date,\n        prd_end_date AS product_end_date\n    FROM \"dwh\".\"snapshots\".\"products_snapshot\"\n    WHERE dbt_valid_to = '9999-12-31'\n)\nSELECT\n    ROW_NUMBER() OVER (ORDER BY product_id) AS product_key,\n    *\nFROM aggregated_product_data", "relation_name": "\"dwh\".\"gold\".\"dim_products_current\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.741213Z", "completed_at": "2025-04-05T20:51:05.749713Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.750170Z", "completed_at": "2025-04-05T20:51:05.750177Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011137008666992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.dim_products_hist", "compiled": true, "compiled_code": "WITH aggregated_product_h AS (\n    SELECT\n        prd_id AS product_id,\n        prd_code AS product_code,\n        prd_nm AS product_name,\n        cat_id AS product_cat_id,\n        erp_cat AS product_category,\n        erp_subcat AS product_subcategory,\n        erp_maintenance_status AS product_maintenance_status,\n        prd_cost AS product_cost,\n        prd_line AS product_line,\n        prd_start_date AS product_start_date,\n        prd_end_date AS product_end_date,\n        dbt_valid_from AS valid_from,\n        dbt_valid_to AS valid_to\n    FROM \"dwh\".\"snapshots\".\"products_snapshot\"\n)\nSELECT\n    ROW_NUMBER() OVER (ORDER BY product_id, valid_from) AS product_key,\n    *\nFROM aggregated_product_h", "relation_name": "\"dwh\".\"gold\".\"dim_products_hist\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.745226Z", "completed_at": "2025-04-05T20:51:05.750780Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.751920Z", "completed_at": "2025-04-05T20:51:05.751925Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007748126983642578, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_products_snapshot_erp_maintenance_status__Yes__No.8d1595112e", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        erp_maintenance_status as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"snapshots\".\"products_snapshot\"\n    group by erp_maintenance_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Yes','No'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.754386Z", "completed_at": "2025-04-05T20:51:05.767929Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.768428Z", "completed_at": "2025-04-05T20:51:05.768435Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016019821166992188, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_products_snapshot_erp_maintenance_status.837fe8b155", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"snapshots\".\"products_snapshot\"\nwhere erp_maintenance_status != trim(erp_maintenance_status)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.763087Z", "completed_at": "2025-04-05T20:51:05.770966Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.771843Z", "completed_at": "2025-04-05T20:51:05.771851Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0180511474609375, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_products_snapshot_prd_cost___0.fb10396e3b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"snapshots\".\"products_snapshot\"\n\nwhere not(prd_cost >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.772613Z", "completed_at": "2025-04-05T20:51:05.785924Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.786476Z", "completed_at": "2025-04-05T20:51:05.786484Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016584157943725586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_products_snapshot_dbt_scd_id.3b1bf37123", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_scd_id\nfrom \"dwh\".\"snapshots\".\"products_snapshot\"\nwhere dbt_scd_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.782077Z", "completed_at": "2025-04-05T20:51:05.788215Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.788988Z", "completed_at": "2025-04-05T20:51:05.788995Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007880926132202148, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_products_snapshot_dbt_updated_at.f51bf4bd85", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_updated_at\nfrom \"dwh\".\"snapshots\".\"products_snapshot\"\nwhere dbt_updated_at is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.789615Z", "completed_at": "2025-04-05T20:51:05.803545Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.803957Z", "completed_at": "2025-04-05T20:51:05.803966Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.016278982162475586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_products_snapshot_dbt_valid_from.5230dba4ac", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_valid_from\nfrom \"dwh\".\"snapshots\".\"products_snapshot\"\nwhere dbt_valid_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.798824Z", "completed_at": "2025-04-05T20:51:05.805531Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.806854Z", "completed_at": "2025-04-05T20:51:05.806863Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009080171585083008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_products_snapshot_dbt_valid_to.8a79b7bfba", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect dbt_valid_to\nfrom \"dwh\".\"snapshots\".\"products_snapshot\"\nwhere dbt_valid_to is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.807991Z", "completed_at": "2025-04-05T20:51:05.819322Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.819855Z", "completed_at": "2025-04-05T20:51:05.819863Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.014983892440795898, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_products_snapshot_prd_cost.4ac4c0c981", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect prd_cost\nfrom \"dwh\".\"snapshots\".\"products_snapshot\"\nwhere prd_cost is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.814314Z", "completed_at": "2025-04-05T20:51:05.821368Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.822081Z", "completed_at": "2025-04-05T20:51:05.822088Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00873708724975586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.relationships_products_snapshot_cat_id__id__ref_erp_px_cat_g1v2_.cc6c4d367a", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select cat_id as from_field\n    from \"dwh\".\"snapshots\".\"products_snapshot\"\n    where cat_id is not null\n),\n\nparent as (\n    select id as to_field\n    from \"dwh\".\"silver\".\"erp_px_cat_g1v2\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.822702Z", "completed_at": "2025-04-05T20:51:05.831972Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.832400Z", "completed_at": "2025-04-05T20:51:05.832405Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.011506080627441406, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_products_snapshot_dbt_scd_id.64e0b38135", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    dbt_scd_id as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"snapshots\".\"products_snapshot\"\nwhere dbt_scd_id is not null\ngroup by dbt_scd_id\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.828180Z", "completed_at": "2025-04-05T20:51:05.832968Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.833700Z", "completed_at": "2025-04-05T20:51:05.833705Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006334781646728516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_dim_customers_current_customer_gender__Male__Female__n_a.d1e41f77b4", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_gender as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"gold\".\"dim_customers_current\"\n    group by customer_gender\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Male','Female','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.835915Z", "completed_at": "2025-04-05T20:51:05.844391Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.844851Z", "completed_at": "2025-04-05T20:51:05.844857Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010718107223510742, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_dim_customers_current_customer_marital_status__Married__Single__n_a.f9912a886b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_marital_status as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"gold\".\"dim_customers_current\"\n    group by customer_marital_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Married','Single','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.840372Z", "completed_at": "2025-04-05T20:51:05.845434Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.846224Z", "completed_at": "2025-04-05T20:51:05.846229Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010845184326171875, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_dim_customers_current_customer_firstname.6ffb6e70e8", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"gold\".\"dim_customers_current\"\nwhere customer_firstname != trim(customer_firstname)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.848344Z", "completed_at": "2025-04-05T20:51:05.858870Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.859319Z", "completed_at": "2025-04-05T20:51:05.859326Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012624025344848633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_dim_customers_current_customer_lastname.4fb9107fc7", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"gold\".\"dim_customers_current\"\nwhere customer_lastname != trim(customer_lastname)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.854263Z", "completed_at": "2025-04-05T20:51:05.859914Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.860793Z", "completed_at": "2025-04-05T20:51:05.860798Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.012893199920654297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_customers_current_customer_birthdate___CURRENT_DATE_INTERVAL_18_years_.722cf38f8a", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom (select * from \"dwh\".\"gold\".\"dim_customers_current\" where customer_birthdate IS NOT NULL) dbt_subquery\n\nwhere not(customer_birthdate <= CURRENT_DATE - INTERVAL '18 years')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.862898Z", "completed_at": "2025-04-05T20:51:05.871336Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.871758Z", "completed_at": "2025-04-05T20:51:05.871765Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010456085205078125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_customers_current_customer_create_date___CURRENT_DATE.a7cb8fcbd9", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_customers_current\"\n\nwhere not(customer_create_date <= CURRENT_DATE)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.867527Z", "completed_at": "2025-04-05T20:51:05.872395Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.873422Z", "completed_at": "2025-04-05T20:51:05.873427Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010983943939208984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.email_check_dim_customers_current_customer_email.510a4f64f7", "compiled": true, "compiled_code": "\nSELECT \n    *\nFROM \"dwh\".\"gold\".\"dim_customers_current\"\nWHERE \n    customer_email IS NOT NULL\n    AND customer_email != 'unknown'\n    AND customer_email !~ '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$'\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.875717Z", "completed_at": "2025-04-05T20:51:05.883309Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.883688Z", "completed_at": "2025-04-05T20:51:05.883694Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009671211242675781, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_current_customer_code.dc65fd1b8d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_code\nfrom \"dwh\".\"gold\".\"dim_customers_current\"\nwhere customer_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.879779Z", "completed_at": "2025-04-05T20:51:05.885319Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.888968Z", "completed_at": "2025-04-05T20:51:05.888973Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013701200485229492, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_current_customer_create_date.f9357ccf66", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_create_date\nfrom \"dwh\".\"gold\".\"dim_customers_current\"\nwhere customer_create_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.885640Z", "completed_at": "2025-04-05T20:51:05.890866Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.894890Z", "completed_at": "2025-04-05T20:51:05.894896Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010389089584350586, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_current_customer_id.1e15b0f415", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"dwh\".\"gold\".\"dim_customers_current\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.891211Z", "completed_at": "2025-04-05T20:51:05.901095Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.901528Z", "completed_at": "2025-04-05T20:51:05.901533Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.01156926155090332, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_current_customer_key.37ac625538", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_key\nfrom \"dwh\".\"gold\".\"dim_customers_current\"\nwhere customer_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.896760Z", "completed_at": "2025-04-05T20:51:05.902876Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.903546Z", "completed_at": "2025-04-05T20:51:05.903550Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0076138973236083984, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.relationships_dim_customers_current_customer_code__cid__ref_erp_cust_az12_.0a9649b542", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_code as from_field\n    from \"dwh\".\"gold\".\"dim_customers_current\"\n    where customer_code is not null\n),\n\nparent as (\n    select cid as to_field\n    from \"dwh\".\"silver\".\"erp_cust_az12\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.904072Z", "completed_at": "2025-04-05T20:51:05.915077Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.915572Z", "completed_at": "2025-04-05T20:51:05.915578Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.013190746307373047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.relationships_dim_customers_current_customer_code__cid__ref_erp_loc_a101_.f2a45edd5c", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_code as from_field\n    from \"dwh\".\"gold\".\"dim_customers_current\"\n    where customer_code is not null\n),\n\nparent as (\n    select cid as to_field\n    from \"dwh\".\"silver\".\"erp_loc_a101\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.909667Z", "completed_at": "2025-04-05T20:51:05.917249Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.921067Z", "completed_at": "2025-04-05T20:51:05.921072Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.012225151062011719, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_dim_customers_current_customer_key.08d4b3b146", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_key as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"gold\".\"dim_customers_current\"\nwhere customer_key is not null\ngroup by customer_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.917593Z", "completed_at": "2025-04-05T20:51:05.922537Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.923181Z", "completed_at": "2025-04-05T20:51:05.923186Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006681919097900391, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_dim_customers_hist_customer_gender__Male__Female__n_a.d766a33adc", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_gender as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"gold\".\"dim_customers_hist\"\n    group by customer_gender\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Male','Female','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.923756Z", "completed_at": "2025-04-05T20:51:05.932200Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.932635Z", "completed_at": "2025-04-05T20:51:05.932641Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010565042495727539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_dim_customers_hist_customer_marital_status__Married__Single__n_a.cdaca57546", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        customer_marital_status as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"gold\".\"dim_customers_hist\"\n    group by customer_marital_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Married','Single','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.928780Z", "completed_at": "2025-04-05T20:51:05.933946Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.934607Z", "completed_at": "2025-04-05T20:51:05.934612Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.0066568851470947266, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_dim_customers_hist_customer_firstname.d868abb141", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\nwhere customer_firstname != trim(customer_firstname)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.935185Z", "completed_at": "2025-04-05T20:51:05.939704Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.943925Z", "completed_at": "2025-04-05T20:51:05.943931Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010409116744995117, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_dim_customers_hist_customer_lastname.742a0744a8", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\nwhere customer_lastname != trim(customer_lastname)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.940073Z", "completed_at": "2025-04-05T20:51:05.949606Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.950034Z", "completed_at": "2025-04-05T20:51:05.950041Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011152982711791992, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_customers_hist_customer_birthdate___CURRENT_DATE_INTERVAL_18_years_.31d74b4ea7", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom (select * from \"dwh\".\"gold\".\"dim_customers_hist\" where customer_birthdate IS NOT NULL) dbt_subquery\n\nwhere not(customer_birthdate <= CURRENT_DATE - INTERVAL '18 years')\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.945810Z", "completed_at": "2025-04-05T20:51:05.951366Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.952047Z", "completed_at": "2025-04-05T20:51:05.952051Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007091999053955078, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_customers_hist_customer_create_date___CURRENT_DATE.f81299d118", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\n\nwhere not(customer_create_date <= CURRENT_DATE)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.952581Z", "completed_at": "2025-04-05T20:51:05.958139Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.962124Z", "completed_at": "2025-04-05T20:51:05.962129Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.011187076568603516, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_customers_hist_valid_to___valid_from.0ea133f63d", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\n\nwhere not(valid_to >= valid_from)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.958479Z", "completed_at": "2025-04-05T20:51:05.967190Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.967584Z", "completed_at": "2025-04-05T20:51:05.967590Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010331869125366211, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.email_check_dim_customers_hist_customer_email.99784c6897", "compiled": true, "compiled_code": "\nSELECT \n    *\nFROM \"dwh\".\"gold\".\"dim_customers_hist\"\nWHERE \n    customer_email IS NOT NULL\n    AND customer_email != 'unknown'\n    AND customer_email !~ '^[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Za-z]{2,}$'\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.963948Z", "completed_at": "2025-04-05T20:51:05.968915Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.969519Z", "completed_at": "2025-04-05T20:51:05.969523Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.006384134292602539, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_hist_customer_code.5954a024ee", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_code\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\nwhere customer_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.970032Z", "completed_at": "2025-04-05T20:51:05.979043Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.979378Z", "completed_at": "2025-04-05T20:51:05.979382Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010894060134887695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_hist_customer_create_date.bd19ea11a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_create_date\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\nwhere customer_create_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.976098Z", "completed_at": "2025-04-05T20:51:05.979839Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.980457Z", "completed_at": "2025-04-05T20:51:05.980461Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005068063735961914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_hist_customer_id.ce18adacfe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_id\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\nwhere customer_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.982213Z", "completed_at": "2025-04-05T20:51:05.988337Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.988648Z", "completed_at": "2025-04-05T20:51:05.988652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.007797956466674805, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_hist_customer_key.60fa59698a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect customer_key\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\nwhere customer_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.985394Z", "completed_at": "2025-04-05T20:51:05.989113Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.989727Z", "completed_at": "2025-04-05T20:51:05.989731Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007877111434936523, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_hist_valid_from.eea34cae68", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valid_from\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\nwhere valid_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.991403Z", "completed_at": "2025-04-05T20:51:05.998365Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:05.998690Z", "completed_at": "2025-04-05T20:51:05.998695Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008575916290283203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_customers_hist_valid_to.1f4b64bed1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valid_to\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\nwhere valid_to is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:05.994609Z", "completed_at": "2025-04-05T20:51:05.999521Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.000098Z", "completed_at": "2025-04-05T20:51:06.000102Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009057998657226562, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.relationships_dim_customers_hist_customer_code__cid__ref_erp_cust_az12_.e1cbda855d", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_code as from_field\n    from \"dwh\".\"gold\".\"dim_customers_hist\"\n    where customer_code is not null\n),\n\nparent as (\n    select cid as to_field\n    from \"dwh\".\"silver\".\"erp_cust_az12\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.001277Z", "completed_at": "2025-04-05T20:51:06.008380Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.008716Z", "completed_at": "2025-04-05T20:51:06.008720Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009001970291137695, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.relationships_dim_customers_hist_customer_code__cid__ref_erp_loc_a101_.1cff523225", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_code as from_field\n    from \"dwh\".\"gold\".\"dim_customers_hist\"\n    where customer_code is not null\n),\n\nparent as (\n    select cid as to_field\n    from \"dwh\".\"silver\".\"erp_loc_a101\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.005533Z", "completed_at": "2025-04-05T20:51:06.009516Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.010075Z", "completed_at": "2025-04-05T20:51:06.010078Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005287885665893555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_dim_customers_hist_customer_key.e6329f08c7", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    customer_key as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"gold\".\"dim_customers_hist\"\nwhere customer_key is not null\ngroup by customer_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.011097Z", "completed_at": "2025-04-05T20:51:06.017602Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.017895Z", "completed_at": "2025-04-05T20:51:06.017899Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008193016052246094, "adapter_response": {}, "message": null, "failures": null, "unique_id": "model.dbt_transform.fact_sales", "compiled": true, "compiled_code": "\n\nWITH customer_dim AS (\n    SELECT *\n    FROM \"dwh\".\"gold\".\"dim_customers_current\"\n),\nproducts_dim AS (\n    SELECT *\n    FROM \"dwh\".\"gold\".\"dim_products_current\"\n),\nsource_sales_data AS (\n    SELECT *\n    FROM \"dwh\".\"silver\".\"crm_sales_details\"\n),\naggregated_sales_data AS (\n    SELECT\n        sd.sls_ord_num AS sales_order_number,\n        sd.sls_order_dt AS sales_order_date,\n        sd.sls_ship_dt AS sales_shipping_date,\n        sd.sls_due_dt AS sales_due_date,\n        sd.sls_sales AS sales_amount,\n        sd.sls_quantity AS sales_quantity,\n        sd.sls_price AS sales_price,\n        dp.product_key,\n        dc.customer_key\n    FROM source_sales_data sd\n    LEFT JOIN customer_dim dc ON sd.sls_cust_id = dc.customer_id\n    LEFT JOIN products_dim dp ON sd.sls_prd_key = dp.product_code\n)\nSELECT\n    MD5(COALESCE(sales_order_number, '') || COALESCE(product_key::VARCHAR, '0') || COALESCE(customer_key::VARCHAR, '0')) AS sales_details_key,  -- Fixed name and null handling\n    product_key,\n    customer_key,\n    sales_order_number,\n    sales_order_date,\n    sales_shipping_date,\n    sales_due_date,\n    sales_amount,\n    sales_quantity,\n    sales_price\nFROM aggregated_sales_data", "relation_name": "\"dwh\".\"gold\".\"fact_sales\"", "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.014604Z", "completed_at": "2025-04-05T20:51:06.019229Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.021608Z", "completed_at": "2025-04-05T20:51:06.021611Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007771730422973633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_dim_products_current_product_line__Mountains__Road__Sales__Touring__n_a.e8f2855826", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        product_line as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"gold\".\"dim_products_current\"\n    group by product_line\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Mountains','Road','Sales','Touring','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.022069Z", "completed_at": "2025-04-05T20:51:06.028917Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.029296Z", "completed_at": "2025-04-05T20:51:06.029301Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.010483980178833008, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_dim_products_current_product_maintenance_status__Yes__No.07bfd01f6a", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        product_maintenance_status as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"gold\".\"dim_products_current\"\n    group by product_maintenance_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Yes','No'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.026228Z", "completed_at": "2025-04-05T20:51:06.030442Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.031008Z", "completed_at": "2025-04-05T20:51:06.031011Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005513191223144531, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_dim_products_current_product_name.0724974f29", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"gold\".\"dim_products_current\"\nwhere product_name != trim(product_name)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.031469Z", "completed_at": "2025-04-05T20:51:06.039047Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.039421Z", "completed_at": "2025-04-05T20:51:06.039426Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009351253509521484, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_products_current_product_cost___0.e6c37c46c8", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_products_current\"\n\nwhere not(product_cost >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.035604Z", "completed_at": "2025-04-05T20:51:06.040255Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.040851Z", "completed_at": "2025-04-05T20:51:06.040855Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005942821502685547, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_products_current_product_end_date___product_start_date.451cdfe750", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_products_current\"\n\nwhere not(product_end_date >= product_start_date)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.041894Z", "completed_at": "2025-04-05T20:51:06.048649Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.048983Z", "completed_at": "2025-04-05T20:51:06.048987Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008510351181030273, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_products_current_product_start_date___CURRENT_DATE.2300366280", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_products_current\"\n\nwhere not(product_start_date <= CURRENT_DATE)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.045780Z", "completed_at": "2025-04-05T20:51:06.049750Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.050361Z", "completed_at": "2025-04-05T20:51:06.050364Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005340099334716797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_current_product_cat_id.c777c239b5", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_cat_id\nfrom \"dwh\".\"gold\".\"dim_products_current\"\nwhere product_cat_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.051376Z", "completed_at": "2025-04-05T20:51:06.057702Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.058036Z", "completed_at": "2025-04-05T20:51:06.058040Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008054018020629883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_current_product_code.e0869b5c14", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_code\nfrom \"dwh\".\"gold\".\"dim_products_current\"\nwhere product_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.054868Z", "completed_at": "2025-04-05T20:51:06.058824Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.059430Z", "completed_at": "2025-04-05T20:51:06.059434Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005304098129272461, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_current_product_end_date.929c3a8649", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_end_date\nfrom \"dwh\".\"gold\".\"dim_products_current\"\nwhere product_end_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.060492Z", "completed_at": "2025-04-05T20:51:06.068605Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.068983Z", "completed_at": "2025-04-05T20:51:06.068988Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009946107864379883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_current_product_id.c8cb27b7ea", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"dwh\".\"gold\".\"dim_products_current\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.064176Z", "completed_at": "2025-04-05T20:51:06.070140Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.070694Z", "completed_at": "2025-04-05T20:51:06.070698Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.007272243499755859, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_current_product_key.3e63d180f9", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_key\nfrom \"dwh\".\"gold\".\"dim_products_current\"\nwhere product_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.071135Z", "completed_at": "2025-04-05T20:51:06.077763Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.078066Z", "completed_at": "2025-04-05T20:51:06.078071Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008306026458740234, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_current_product_name.dd03b9e6f4", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom \"dwh\".\"gold\".\"dim_products_current\"\nwhere product_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.074960Z", "completed_at": "2025-04-05T20:51:06.078890Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.079481Z", "completed_at": "2025-04-05T20:51:06.079484Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005195140838623047, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_current_product_start_date.ca24d0e0fe", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_start_date\nfrom \"dwh\".\"gold\".\"dim_products_current\"\nwhere product_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.080520Z", "completed_at": "2025-04-05T20:51:06.087430Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.087761Z", "completed_at": "2025-04-05T20:51:06.087765Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008661985397338867, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_dim_products_current_product_key.fc3de2b35c", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_key as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"gold\".\"dim_products_current\"\nwhere product_key is not null\ngroup by product_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.084234Z", "completed_at": "2025-04-05T20:51:06.088606Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.089200Z", "completed_at": "2025-04-05T20:51:06.089203Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005747079849243164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_dim_products_hist_product_line__Mountains__Road__Sales__Touring__n_a.a57388378b", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        product_line as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"gold\".\"dim_products_hist\"\n    group by product_line\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Mountains','Road','Sales','Touring','n/a'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.090243Z", "completed_at": "2025-04-05T20:51:06.097704Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.098048Z", "completed_at": "2025-04-05T20:51:06.098053Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009248971939086914, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.accepted_values_dim_products_hist_product_maintenance_status__Yes__No.af5c46a5ea", "compiled": true, "compiled_code": "\n    \n    \n\nwith all_values as (\n\n    select\n        product_maintenance_status as value_field,\n        count(*) as n_records\n\n    from \"dwh\".\"gold\".\"dim_products_hist\"\n    group by product_maintenance_status\n\n)\n\nselect *\nfrom all_values\nwhere value_field not in (\n    'Yes','No'\n)\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.094297Z", "completed_at": "2025-04-05T20:51:06.099553Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.102992Z", "completed_at": "2025-04-05T20:51:06.102997Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009591102600097656, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.custom_trimmed_check_dim_products_hist_product_name.bf225459e3", "compiled": true, "compiled_code": "\n\nselect *\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere product_name != trim(product_name)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.099862Z", "completed_at": "2025-04-05T20:51:06.104546Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.108200Z", "completed_at": "2025-04-05T20:51:06.108206Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.009335756301879883, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_products_hist_product_cost___0.17db2580f3", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\n\nwhere not(product_cost >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.104856Z", "completed_at": "2025-04-05T20:51:06.113028Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.113402Z", "completed_at": "2025-04-05T20:51:06.113407Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.00952601432800293, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_products_hist_product_end_date___product_start_date.939b927a80", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\n\nwhere not(product_end_date >= product_start_date)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.109796Z", "completed_at": "2025-04-05T20:51:06.114291Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.114905Z", "completed_at": "2025-04-05T20:51:06.114909Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005806684494018555, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_products_hist_product_start_date___CURRENT_DATE.dedbbf6f62", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\n\nwhere not(product_start_date <= CURRENT_DATE)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.115940Z", "completed_at": "2025-04-05T20:51:06.124445Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.124785Z", "completed_at": "2025-04-05T20:51:06.124790Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010283946990966797, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_dim_products_hist_valid_to___valid_from.375df757f5", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\n\nwhere not(valid_to >= valid_from)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.121577Z", "completed_at": "2025-04-05T20:51:06.125626Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.126199Z", "completed_at": "2025-04-05T20:51:06.126202Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00537419319152832, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_hist_product_cat_id.d281f01d43", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_cat_id\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere product_cat_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.127209Z", "completed_at": "2025-04-05T20:51:06.133668Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.133995Z", "completed_at": "2025-04-05T20:51:06.134000Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008178949356079102, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_hist_product_code.c6aaeb0242", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_code\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere product_code is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.130792Z", "completed_at": "2025-04-05T20:51:06.134783Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.135371Z", "completed_at": "2025-04-05T20:51:06.135375Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.0053272247314453125, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_hist_product_end_date.a81a2dc90d", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_end_date\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere product_end_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.136450Z", "completed_at": "2025-04-05T20:51:06.142843Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.143149Z", "completed_at": "2025-04-05T20:51:06.143153Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008152961730957031, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_hist_product_id.6a326106a1", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_id\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere product_id is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.139962Z", "completed_at": "2025-04-05T20:51:06.143927Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.144561Z", "completed_at": "2025-04-05T20:51:06.144564Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005319833755493164, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_hist_product_key.5c97ee0e15", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_key\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere product_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.145602Z", "completed_at": "2025-04-05T20:51:06.152114Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.152452Z", "completed_at": "2025-04-05T20:51:06.152456Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008280754089355469, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_hist_product_name.d9be5ad187", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_name\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere product_name is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.149188Z", "completed_at": "2025-04-05T20:51:06.153272Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.153838Z", "completed_at": "2025-04-05T20:51:06.153841Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00538325309753418, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_hist_product_start_date.54f355684a", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect product_start_date\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere product_start_date is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.154873Z", "completed_at": "2025-04-05T20:51:06.161177Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.161515Z", "completed_at": "2025-04-05T20:51:06.161520Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008051156997680664, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_hist_valid_from.3aa7d58fff", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valid_from\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere valid_from is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.158368Z", "completed_at": "2025-04-05T20:51:06.162278Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.162900Z", "completed_at": "2025-04-05T20:51:06.162904Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005286216735839844, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_dim_products_hist_valid_to.8dcbbd24da", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect valid_to\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere valid_to is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.163934Z", "completed_at": "2025-04-05T20:51:06.172833Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.173183Z", "completed_at": "2025-04-05T20:51:06.173188Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010664224624633789, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_dim_products_hist_product_key.a6021809c2", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    product_key as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"gold\".\"dim_products_hist\"\nwhere product_key is not null\ngroup by product_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.169241Z", "completed_at": "2025-04-05T20:51:06.173990Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.174623Z", "completed_at": "2025-04-05T20:51:06.174626Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.006226062774658203, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_fact_sales_sales_amount___0.df4e090748", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom (select * from \"dwh\".\"gold\".\"fact_sales\" where sales_amount IS NOT NULL) dbt_subquery\n\nwhere not(sales_amount  >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.175669Z", "completed_at": "2025-04-05T20:51:06.183065Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.183382Z", "completed_at": "2025-04-05T20:51:06.183387Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.009145021438598633, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_fact_sales_sales_due_date___sales_order_date.739676ef8b", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom (select * from \"dwh\".\"gold\".\"fact_sales\" where sales_due_date IS NOT NULL AND sales_order_date IS NOT NULL) dbt_subquery\n\nwhere not(sales_due_date >= sales_order_date)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.179909Z", "completed_at": "2025-04-05T20:51:06.184201Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.184841Z", "completed_at": "2025-04-05T20:51:06.184845Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005683183670043945, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_fact_sales_sales_order_date___CURRENT_DATE.89a8a9abbc", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom \"dwh\".\"gold\".\"fact_sales\"\n\nwhere not(sales_order_date <= CURRENT_DATE)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.185920Z", "completed_at": "2025-04-05T20:51:06.192965Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.193278Z", "completed_at": "2025-04-05T20:51:06.193283Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008835077285766602, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_fact_sales_sales_quantity___0.478922c950", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom (select * from \"dwh\".\"gold\".\"fact_sales\" where sales_quantity IS NOT NULL) dbt_subquery\n\nwhere not(sales_quantity >= 0)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.189852Z", "completed_at": "2025-04-05T20:51:06.194422Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.194994Z", "completed_at": "2025-04-05T20:51:06.194997Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.00593113899230957, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.dbt_utils_expression_is_true_fact_sales_sales_shipping_date___sales_order_date.2343579795", "compiled": true, "compiled_code": "\n\n\n\nselect\n    1\nfrom (select * from \"dwh\".\"gold\".\"fact_sales\" where sales_shipping_date IS NOT NULL AND sales_order_date IS NOT NULL) dbt_subquery\n\nwhere not(sales_shipping_date >= sales_order_date)\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.195453Z", "completed_at": "2025-04-05T20:51:06.202008Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.202377Z", "completed_at": "2025-04-05T20:51:06.202382Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.008345842361450195, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.fact_sales_join_check", "compiled": true, "compiled_code": "SELECT \n    fs.*\nFROM \"dwh\".\"gold\".\"fact_sales\" fs\nLEFT JOIN \"dwh\".\"gold\".\"dim_customers_current\" dc \n    ON dc.customer_key = fs.customer_key\nLEFT JOIN \"dwh\".\"gold\".\"dim_products_current\" dp \n    ON dp.product_key = fs.product_key\nWHERE \n    dc.customer_key IS NULL \n    OR dp.product_key IS NULL", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.198945Z", "completed_at": "2025-04-05T20:51:06.203862Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.207054Z", "completed_at": "2025-04-05T20:51:06.207058Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.008829116821289062, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_fact_sales_sales_details_key.0281f867b8", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_details_key\nfrom \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_details_key is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.204150Z", "completed_at": "2025-04-05T20:51:06.208300Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.208848Z", "completed_at": "2025-04-05T20:51:06.208853Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.005691051483154297, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.not_null_fact_sales_sales_order_number.804723385c", "compiled": true, "compiled_code": "\n    \n    \n\n\n\nselect sales_order_number\nfrom \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_order_number is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.209325Z", "completed_at": "2025-04-05T20:51:06.221229Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.221646Z", "completed_at": "2025-04-05T20:51:06.221652Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.01376485824584961, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.relationships_fact_sales_customer_key__customer_key__ref_dim_customers_current_.7f8b6f7f32", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select customer_key as from_field\n    from \"dwh\".\"gold\".\"fact_sales\"\n    where customer_key is not null\n),\n\nparent as (\n    select customer_key as to_field\n    from \"dwh\".\"gold\".\"dim_customers_current\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.216856Z", "completed_at": "2025-04-05T20:51:06.223180Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.226698Z", "completed_at": "2025-04-05T20:51:06.226706Z"}], "thread_id": "Thread-2 (worker)", "execution_time": 0.010651826858520508, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.relationships_fact_sales_product_key__product_key__ref_dim_products_current_.004155aa94", "compiled": true, "compiled_code": "\n    \n    \n\nwith child as (\n    select product_key as from_field\n    from \"dwh\".\"gold\".\"fact_sales\"\n    where product_key is not null\n),\n\nparent as (\n    select product_key as to_field\n    from \"dwh\".\"gold\".\"dim_products_current\"\n)\n\nselect\n    from_field\n\nfrom child\nleft join parent\n    on child.from_field = parent.to_field\n\nwhere parent.to_field is null\n\n\n", "relation_name": null, "batch_results": null}, {"status": "success", "timing": [{"name": "compile", "started_at": "2025-04-05T20:51:06.223461Z", "completed_at": "2025-04-05T20:51:06.227559Z"}, {"name": "execute", "started_at": "2025-04-05T20:51:06.227874Z", "completed_at": "2025-04-05T20:51:06.227878Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 0.005425214767456055, "adapter_response": {}, "message": null, "failures": null, "unique_id": "test.dbt_transform.unique_fact_sales_sales_details_key.5f8b370051", "compiled": true, "compiled_code": "\n    \n    \n\nselect\n    sales_details_key as unique_field,\n    count(*) as n_records\n\nfrom \"dwh\".\"gold\".\"fact_sales\"\nwhere sales_details_key is not null\ngroup by sales_details_key\nhaving count(*) > 1\n\n\n", "relation_name": null, "batch_results": null}], "elapsed_time": 1.881932020187378, "args": {"quiet": false, "vars": {}, "introspect": true, "invocation_command": "dbt docs generate --profile dbt_duckdb", "log_format_file": "debug", "require_yaml_configuration_for_mf_time_spines": false, "indirect_selection": "eager", "source_freshness_run_project_hooks": false, "state_modified_compare_vars": false, "which": "generate", "use_colors": true, "require_resource_names_without_spaces": false, "printer_width": 80, "require_nested_cumulative_type_params": false, "static": false, "cache_selected_only": false, "write_json": true, "use_colors_file": true, "profile": "dbt_duckdb", "favor_state": false, "compile": true, "require_explicit_package_overrides_for_builtin_materializations": true, "send_anonymous_usage_stats": true, "log_path": "/Users/dross/Desktop/educ/dbt-bike-insights/dbt_transform/logs", "log_level": "info", "strict_mode": false, "partial_parse": true, "populate_cache": true, "log_level_file": "debug", "macro_debugging": false, "select": [], "skip_nodes_if_on_run_start_fails": false, "static_parser": true, "print": true, "show_resource_report": false, "warn_error_options": {"include": [], "exclude": []}, "profiles_dir": "/Users/dross/Desktop/educ/dbt-bike-insights/dbt_transform", "require_batched_execution_for_custom_microbatch_strategy": false, "version_check": true, "log_file_max_bytes": 10485760, "defer": false, "log_format": "default", "state_modified_compare_more_unrendered_values": false, "project_dir": "/Users/dross/Desktop/educ/dbt-bike-insights/dbt_transform", "empty_catalog": false, "exclude": [], "partial_parse_file_diff": true}}